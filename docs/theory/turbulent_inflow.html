

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Theory &mdash; TInF Tool 0.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="1. Building TInF" href="../building.html" />
    <link rel="prev" title="8. Copyright and License" href="../copyright.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> TInF Tool
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgment.html">1. Acknowledgments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">2. About TInF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">3. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userManual.html">4. User Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">5. TroubleShooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples.html">6. Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">7. Bugs &amp; Feauture Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">8. Copyright and License</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Manual</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">1.1. Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#synthetic-random-fourier-method">1.2. Synthetic Random Fourier Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#digital-filtering-method">1.3. Digital Filtering Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#synthetic-eddy-method">1.4. Synthetic Eddy Method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mean-flow-and-reynolds-stresses">Mean Flow and Reynolds Stresses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-point-correlation">Two-point Correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#two-time-correlation">Two-time Correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#commonly-used-velocity-shape-functions">Commonly Used Velocity Shape Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#divergence-free-synthetic-eddy-method">1.5. Divergence Free Synthetic Eddy Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="#turbulent-spot-method-with-anisotropic-vorton">1.6. Turbulent Spot Method with Anisotropic Vorton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#statistical-properties-of-anisotropic-vortons">Statistical Properties of Anisotropic Vortons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determination-of-anisotropic-vorton-parameters">Determination of Anisotropic Vorton Parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#code-implementation">2. Code Implementation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#modifications-regarding-the-controldict-file">2.1. Modifications regarding the controlDict file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modifications-regarding-the-u-file">2.2. Modifications regarding the U file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-turbulentdfminlet-boundary-condition">The turbulentDFMInlet boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-turbulentseminlet-boundary-condition">The turbulentSEMInlet boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-turbulentdfseminlet-boundary-condition">The turbulentDFSEMInlet boundary condition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-turbulentatsminlet-boundary-condition">The turbulentATSMInlet boundary condition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#specification-of-the-statistics-of-the-target-turbulence">2.3. Specification of the statistics of the target turbulence</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#direct-specification">Direct specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specification-via-interpolation">Specification via interpolation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#specification-via-prescribed-functions">Specification via prescribed functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">2.4. References</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Developer Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../building.html">1. Building TInF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../validation/TinFverification.html">2. Verification of the Turbulence Inflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../codingStyle.html">3. Coding Style</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TInF Tool</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">1. </span>Theory</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/theory/turbulent_inflow.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="theory">
<span id="chap-theory"></span><span id="sec-tinf-theory"></span><h1><span class="section-number">1. </span>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2><span class="section-number">1.1. </span>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In computational wind engineering (CWE), generation of inflow turbulence satisfying prescribed mean-velocity profiles, turbulence spectra, spatial and temporal correlations is of great importance for the accurate evaluation of wind effects on buildings and structures. More specifically, the task is to generate a turbulent velocity field <span class="math notranslate nohighlight">\(\mathbf{u}(\mathbf{x},t)\)</span> with the form</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-0">
<span class="eqno">(1.1)<a class="headerlink" href="#equation-theory-turbulent-inflow-0" title="Permalink to this equation">¶</a></span>\[\mathbf{u}(\mathbf{x},t) = \mathbf{U}(\mathbf{x},t)+\mathbf{u}'(\mathbf{x},t)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{U}(\mathbf{x},t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{u}'(\mathbf{x},t)\)</span> are the mean and fluctuating velocities at the position <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. The turbulent velocity field <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> and its fluctuation <span class="math notranslate nohighlight">\(\mathbf{u}'\)</span> need to satisfy a number of properties which are list below:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}'\)</span> should be spatially and temporally correlated.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}'\)</span> needs to have prescribed Reynolds stresses tensor <span class="math notranslate nohighlight">\(R_{ij}(\mathbf{x}) = \langle u_i'u_j'\rangle(\mathbf{x})\)</span> where <span class="math notranslate nohighlight">\(u_i'\)</span> (<span class="math notranslate nohighlight">\(i=1,2,3\)</span>) is the <span class="math notranslate nohighlight">\(i\)</span>-th component of <span class="math notranslate nohighlight">\(\mathbf{u}'\)</span>  and the angles denote the time average.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}'\)</span> needs to have prescribed integral length scales <span class="math notranslate nohighlight">\(L_{ij}(\mathbf{x},\mathbf{e})\)</span></p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-1">
<span class="eqno">(1.2)<a class="headerlink" href="#equation-theory-turbulent-inflow-1" title="Permalink to this equation">¶</a></span>\[L_{ij}(\mathbf{x},\mathbf{e}) = \int_{0}^{\infty} \rho_{ij}(\mathbf{x},r\mathbf{e})\ \mathrm{d}r,\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_{ij}(\mathbf{x},\mathbf{e})\)</span> is the correlation function given by</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-2">
<span class="eqno">(1.3)<a class="headerlink" href="#equation-theory-turbulent-inflow-2" title="Permalink to this equation">¶</a></span>\[\rho_{ij}(\mathbf{x},\mathbf{e}) = \frac{\langle u_i'(\mathbf{x},t)u_j'(\mathbf{x}+\mathbf{e},t)\rangle}{\langle u_i'(\mathbf{x},t)u_j'(\mathbf{x},t) \rangle}.\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}\)</span> should fulfil the divergence free constraint <span class="math notranslate nohighlight">\(\nabla \cdot \mathbf{u} = 0\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{u}'\)</span> should have prescribed correlation functions <span class="math notranslate nohighlight">\(\rho_{ij}(\mathbf{x},\mathbf{e})\)</span> or spectra.</p></li>
</ul>
<p>Several methodologies have been proposed for this purpose which can be classified into three general categories: precursor simulation methods, recycling methods and synthetic methods. Compared with precursor simulation and recycling methods, the synthetic methods in general offer a more practical and relatively efficient approach to generate inflow turbulence, and is therefore chosen as the subject of this section. Research activities on synthetic turbulence generation have been vigorous over the past decades and have branched out into several categories of techniques <a class="bibtex reference internal" href="#wu2017" id="id1">[5]</a>, including the synthetic random Fourier method <a class="bibtex reference internal" href="#kraichnan1970" id="id2">[6]</a><a class="bibtex reference internal" href="#hoshiya1972" id="id3">[7]</a>, the synthetic digital filtering method <a class="bibtex reference internal" href="#klein2003" id="id4">[8]</a> and the synthetic eddy methods <a class="bibtex reference internal" href="#jarrin2006" id="id5">[2]</a>. A brief introduction regarding to these techniques is given below and emphasis is placed on their abilities to capture the statistical characteristics as well as the spatial and temporal coherence of turbulence. Also note that since real turbulence is very complex, in most cases, not all of the above listed features can be fulfilled. There is always some adaptation time required for the artificial turbulence to evolve into real turbulence. Fulfilling the properties above with the synthetic turbulence is important to minimize the adaptation time or length.</p>
</div>
<div class="section" id="synthetic-random-fourier-method">
<h2><span class="section-number">1.2. </span>Synthetic Random Fourier Method<a class="headerlink" href="#synthetic-random-fourier-method" title="Permalink to this headline">¶</a></h2>
<p>The so-called synthetic random Fourier method (SRFM) attempts to model turbulent flow field indirectly by imposing constraints on uncorrelated random fields through an energy spectrum to account for the spatial and temporal correlations, which can be further classified into two groups.
The first group of the SRFM was based on the pioneering work in <a class="bibtex reference internal" href="#hoshiya1972" id="id6">[7]</a> and <a class="bibtex reference internal" href="#shinozuka1972" id="id7">[9]</a> on the simulation of multi-correlated random processes using a weighted amplitude wave superposition (WAWS) method. This approach has an advantage that both the targeted power- and cross-spectra can be imposed in the generation process so that the prescribed target characteristics can be maintained. A major drawback of this method is that the generated turbulence does not satisfy the continuity equation of the flow, or in other words, the divergence-free condition is not guaranteed. As a consequence it would take enormous effort for the solver to enforce the continuity by correcting the turbulence inflow inserted into the computational domain, and the statistical characteristics of the corrected flow field differs from the target values.</p>
<p>The second group of the SRFM was initiated by the work in <a class="bibtex reference internal" href="#kraichnan1970" id="id8">[6]</a> on divergence-free homogeneous isotropic turbulence synthesis through the superposition of random harmonic functions. <a class="bibtex reference internal" href="#smirnov2001" id="id9">[10]</a> took a step forward by combing Kraichnan’s technique with scaling and orthogonal transformation operations in a procedure known as the random flow generation (RFG) which allows to generate inhomogeneous and anisotropic turbulence. However the scaling operation introduced in the RFG technique can result in a velocity field that is not divergence-free for inhomogeneous turbulence. Modifications to enforce the divergence-free constraint for inhomogeneous turbulence was discussed in <a class="bibtex reference internal" href="#yu2014" id="id10">[11]</a>. A major drawback of RFG technique is that the power-spectra of the generated turbulence only follows Gaussian’s spectra model, so it is not suitable for simulating flows in atmospheric boundary layer. <a class="bibtex reference internal" href="#huang2010" id="id11">[12]</a> revisited Kraichnan’s method and proposed a technique called DSRFG (for discretizing and synthesizing random flow generation) which allows to generate turbulent inflow from any prescribed spectrum. Instead of using the scaling and orthogonal transformation, the anisotropy of turbulence is realized by modifying the distribution strategy of the wave vector in Kraichnan’s original method. A drawback of the DSRFG technique is that it produces fluctuating velocities with high correlation due to the fact that in this method the spatial correlation is modelled by a parameter which is not a function of frequency but a constant value. Inspired by the DSRFG method, <a class="bibtex reference internal" href="#castro2017" id="id12">[13]</a> proposed some modifications to this technique to obtain the velocity field that had a better match with the target turbulent statistics. This method, known as modified discretizing and synthesizing random flow generation (MDSRFG), is capable of removing the dependence of statistic quantities of synthetic turbulence on spectra discretization resolution. <a class="bibtex reference internal" href="#aboshosha2015" id="id13">[14]</a> also proposed a technique called consistent discrete RFG (CDRFG) to accurately model the target spectra and the coherence function. In both two methods mentioned above, the parameter that characterizes the spatial correlation is expressed as a function of frequency to account for the damping of coherence with the increase of frequency. An attractive feature of second group of SRFM is that the generation procedures are usually independent at each point and each time-instant so that it can be easily accelerated by conducting parallel computation, although the generated random flow may not satisfy the continuity equation.</p>
</div>
<div class="section" id="digital-filtering-method">
<span id="sectiondfm"></span><h2><span class="section-number">1.3. </span>Digital Filtering Method<a class="headerlink" href="#digital-filtering-method" title="Permalink to this headline">¶</a></h2>
<p>The digital filtering method (DFM) initiated by <a class="bibtex reference internal" href="#klein2003" id="id14">[8]</a> attempts to model the spatial and temporal coherence of turbulent inflow through the digital filtering uncorrelated random data, and account for inhomogeneity and anisotropy using the method proposed by <a class="bibtex reference internal" href="#lund1998" id="id15">[15]</a>. It is relatively easy to implement and is able to reproduce the first and second order one-point statistics as well as auto-correlation function. However, the synthetic turbulence generated by DFM does not satisfy the continuity equation. <a class="bibtex reference internal" href="#kim2013" id="id16">[16]</a> offered a promising approach to enforce the divergence-free constraint in the DFM by inserting the synthetic turbulence on a transverse plane near the inlet and relying on pressure-velocity coupling to do the correction. From a computational wind engineering point of view, the ability of DFM to impose a two-point spatial correlation directly is very attractive.</p>
<p>A brief introduction on the filtering method by <a class="bibtex reference internal" href="#klein2003" id="id17">[8]</a> is stated as follows. In order to create two-point correlations, let <span class="math notranslate nohighlight">\(r_m\)</span> be a series of random data with zero mean and unity variance, then</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-3">
<span class="eqno">(1.4)<a class="headerlink" href="#equation-theory-turbulent-inflow-3" title="Permalink to this equation">¶</a></span>\[u_m = \sum_{n=-N}^N b_n r_{m+n}\]</div>
<p>defines a convolution or a digital linear non-recursive filter. The <span class="math notranslate nohighlight">\(b_n\)</span> are filter coefficients and <span class="math notranslate nohighlight">\(N\)</span> is related to the length of the filter. The independence between two different random numbers <span class="math notranslate nohighlight">\(r_m\)</span> and <span class="math notranslate nohighlight">\(r_n\)</span> implies that <span class="math notranslate nohighlight">\(\langle r_m r_n \rangle = 0\)</span> for <span class="math notranslate nohighlight">\(m \neq n\)</span> and consequently the two-point correlation between <span class="math notranslate nohighlight">\(u_{m}\)</span> and <span class="math notranslate nohighlight">\(u_{m+k}\)</span> writes</p>
<div class="math notranslate nohighlight" id="equation-sdf1">
<span class="eqno">(1.5)<a class="headerlink" href="#equation-sdf1" title="Permalink to this equation">¶</a></span>\[R_{uu}(k\Delta x) = \frac{\langle u_{m} u_{m+k} \rangle}{\langle u_{m} u_{m} \rangle} = \sum_{j=-N+k}^N b_j b_{j-k} / \sum_{j=-N}^N b_j^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta x\)</span> is the grid spacing. Note that <span class="math notranslate nohighlight">\(u_{m}\)</span> and <span class="math notranslate nohighlight">\(u_{m+k}\)</span> can be interpolated as the values of a random variable field (e.g., velocity) at two distinct grid points with a distance <span class="math notranslate nohighlight">\(k\Delta x\)</span> defined on a one dimensional axis. It is straightforward to tell <a class="reference internal" href="#equation-sdf1">(1.5)</a> defines a relation between the filter coefficients and the correlation function of <span class="math notranslate nohighlight">\(u_m\)</span> (denoted by <span class="math notranslate nohighlight">\(R_{uu}\)</span> hereafter). This suggests that a prescribed correlation function can be reproduced through a careful determination of the filter coefficients. Also note that the coefficients should be determined such that the resulting correlation function fulfil some basic properties like <span class="math notranslate nohighlight">\(R_{uu}(0)=1\)</span>, <span class="math notranslate nohighlight">\(R_{uu}(\infty) = 0\)</span> and the prescribed integral length scales.</p>
<p>For a general target correlation function, the filter coefficients <span class="math notranslate nohighlight">\(b_n\)</span> can be computed by solving a system of non-linear equations in the form of <a class="reference internal" href="#equation-sdf1">(1.5)</a> with a multidimensional Newton iteration method. The procedure can be taken from a standard textbook and needs no further comment. However, for a Gaussian or an exponential type of correlation function, there exists a simple but approximate prescribed solution. More specifically, for a Gaussian correlation function in the form of</p>
<div class="math notranslate nohighlight" id="equation-gaussian">
<span class="eqno">(1.6)<a class="headerlink" href="#equation-gaussian" title="Permalink to this equation">¶</a></span>\[R(r) = \mathrm{exp}\left(-\frac{\pi r^2}{4L^2}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the distance and <span class="math notranslate nohighlight">\(L\)</span> is the length scale. It is possible to approximately reproduce <a class="reference internal" href="#equation-gaussian">(1.6)</a> by computing the filter coefficients as</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-4">
<span class="eqno">(1.7)<a class="headerlink" href="#equation-theory-turbulent-inflow-4" title="Permalink to this equation">¶</a></span>\[b_k = \tilde{b}_k / \left( \sum_{j=-N}^N \tilde{b}_j^2 \right)^{1/2}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-5">
<span class="eqno">(1.8)<a class="headerlink" href="#equation-theory-turbulent-inflow-5" title="Permalink to this equation">¶</a></span>\[\tilde{b}_k = e^{-\frac{\pi k^2}{2n^2}}\]</div>
<p>The width <span class="math notranslate nohighlight">\(N\)</span> of the filter should be chosen such that <span class="math notranslate nohighlight">\(N\geq 2n\)</span> (where <span class="math notranslate nohighlight">\(n=L\Delta x_1\)</span>) to ensure the accuracy of the approximation. On the other hand, for an exponential correlation function</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-6">
<span class="eqno">(1.9)<a class="headerlink" href="#equation-theory-turbulent-inflow-6" title="Permalink to this equation">¶</a></span>\[R(r) = \mathrm{exp}\left(-\frac{\pi |r|}{2L}\right)\]</div>
<p>It is suggested by <a class="bibtex reference internal" href="#xie2008" id="id18">[1]</a> to evaluate the filter coefficients using</p>
<div class="math notranslate nohighlight" id="equation-exponential">
<span class="eqno">(1.10)<a class="headerlink" href="#equation-exponential" title="Permalink to this equation">¶</a></span>\[b_k = \tilde{b}_k / \left( \sum_{j=-N}^N \tilde{b}_j^2 \right)^{1/2}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-7">
<span class="eqno">(1.11)<a class="headerlink" href="#equation-theory-turbulent-inflow-7" title="Permalink to this equation">¶</a></span>\[\tilde{b}_k = e^{-\frac{\pi|k|}{n}}\]</div>
<p>Again, the width <span class="math notranslate nohighlight">\(N\)</span> of the filter should be chosen such that <span class="math notranslate nohighlight">\(N\geq 2n\)</span> (where <span class="math notranslate nohighlight">\(n=L\Delta x\)</span>) to ensure the accuracy of the approximation. Now we have finished the discussion of the digital filtering method for one-dimensional case. Such a technique of generating spatially (or temporally) correlated data from general random numbers can be easily extended to three dimensional case by introducing multi-index filter coefficients <span class="math notranslate nohighlight">\(b_{ijk}\)</span> defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-8">
<span class="eqno">(1.12)<a class="headerlink" href="#equation-theory-turbulent-inflow-8" title="Permalink to this equation">¶</a></span>\[b(i,j,k) = b_{ijk} = b_i \cdot b_j \cdot b_k\]</div>
<p>An algorithm for generating inflow data may look like this (alternatively one can generate a large volume of data, store it and convect it through the inflow plane by applying Taylor’s hypothesis):</p>
<ol class="loweralpha simple">
<li><p>Choose for each coordinate direction corresponding to the inflow plane a length scale <span class="math notranslate nohighlight">\(L_{22} = n_2\Delta x_2\)</span>, <span class="math notranslate nohighlight">\(L_{33} = n_3\Delta x_3\)</span>, a time scale <span class="math notranslate nohighlight">\(T\)</span> and determine the filter width <span class="math notranslate nohighlight">\(N_{\alpha}\)</span> (<span class="math notranslate nohighlight">\(\alpha =1,2,3\)</span>) accordingly.</p></li>
<li><p>Initialize and store three random fields <span class="math notranslate nohighlight">\(R_{\alpha}\)</span> (again <span class="math notranslate nohighlight">\(\alpha =1,2,3\)</span>) of dimensions <span class="math notranslate nohighlight">\([-N_1:N_1,-N_2+1:M_2+N_2,-N_3+1:M_3+N_3]\)</span> where <span class="math notranslate nohighlight">\(M_2 \times M_3\)</span> denotes the dimensions of computational gird of the inflow plane.</p></li>
<li><p>Compute the filter coefficients <span class="math notranslate nohighlight">\(b(i,j,k)\)</span> with a prescribed function or by a multidimensional Newton method such that the resulting correlation function <a class="reference internal" href="#equation-sdf1">(1.5)</a> meets the target one.</p></li>
<li><p>Applying the following filter operation for <span class="math notranslate nohighlight">\(j=1,\ldots,M_2\)</span>, <span class="math notranslate nohighlight">\(k=1,\ldots,M_3\)</span></p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-9">
<span class="eqno">(1.13)<a class="headerlink" href="#equation-theory-turbulent-inflow-9" title="Permalink to this equation">¶</a></span>\[\Psi_{\alpha}(j,k) = \sum_{i'=-N_1}^{N_1}\sum_{j'=-N_2}^{N_2}\sum_{k'=-N_3}^{N_3}b(i',j',k')R_{\alpha}(i',j+j',k+k')\]</div>
<p>which yields the two-dimensional arrays of spatially correlated data <span class="math notranslate nohighlight">\(\Psi_{\alpha}\)</span>, <span class="math notranslate nohighlight">\(\alpha =1,2,3\)</span>.</p>
<ol class="loweralpha simple" start="5">
<li><p>Output velocity data with the transformation</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-10">
<span class="eqno">(1.14)<a class="headerlink" href="#equation-theory-turbulent-inflow-10" title="Permalink to this equation">¶</a></span>\[u_i(j,k) = U_i + a_{ij}\Psi_j(j,k)\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> are given by <a class="reference internal" href="#equation-lundcoefficients">(1.23)</a>. This step ensures the synthetic velocity reproduces the target mean velocity and Reynolds stress tensor.</p>
<ol class="loweralpha simple" start="6">
<li><p>Discard the first <span class="math notranslate nohighlight">\((x_2,x_3)\)</span>-plane of <span class="math notranslate nohighlight">\(\Psi_{\alpha}\)</span> and shift the whole data: <span class="math notranslate nohighlight">\(\Psi_{\alpha}(i,j,k) = R_{\alpha}(i+1,j,k)\)</span>. Fill the plane <span class="math notranslate nohighlight">\(R_{\alpha}(N_1,j,k)\)</span> with new random numbers.</p></li>
<li><p>Repeat the steps (d):math:<a href="#id19"><span class="problematic" id="id20">`</span></a>sim`(g) for each time step.</p></li>
</ol>
<p>If the target correlation function is an exponential function, an alternative approach by <a class="bibtex reference internal" href="#xie2008" id="id21">[1]</a> can be adopted for generating inflow turbulence which turns out to be much more efficient than the method of <a class="bibtex reference internal" href="#klein2003" id="id22">[8]</a>. Instead of using the filtering operation discussed above, the method of <a class="bibtex reference internal" href="#xie2008" id="id23">[1]</a> obtain the temporal correlation with the expression</p>
<div class="math notranslate nohighlight" id="equation-temporalcorrelation">
<span class="eqno">(1.15)<a class="headerlink" href="#equation-temporalcorrelation" title="Permalink to this equation">¶</a></span>\[\Psi_{\alpha}(t+\Delta t,j,k) = \Psi_{\alpha}(t,j,k)\mathrm{exp}\left(-\frac{\pi \Delta t}{2T} \right)+\varPsi_{\alpha}(t,j,k)\left[1-\mathrm{exp}\left(-\frac{\pi \Delta t}{T} \right)\right]^{0.5}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Psi_{\alpha}(t,j,k)\)</span> and <span class="math notranslate nohighlight">\(\varPsi_{\alpha}(t,j,k)\)</span> are two set of spatially-correlated random data resulting from a two dimensional filtering operation. For simplicity, we write <span class="math notranslate nohighlight">\(\Psi_{\alpha,0}\)</span>, <span class="math notranslate nohighlight">\(\Psi_{\alpha,k}\)</span>, <span class="math notranslate nohighlight">\(\varPsi_{\alpha,0}\)</span> and <span class="math notranslate nohighlight">\(\varPsi_{\alpha,k}\)</span> for <span class="math notranslate nohighlight">\(\Psi_{\alpha}(t,j,k)\)</span>, <span class="math notranslate nohighlight">\(\Psi_{\alpha}(t+k\Delta t,j,k)\)</span>, <span class="math notranslate nohighlight">\(\varPsi_{\alpha}(t,j,k)\)</span> and <span class="math notranslate nohighlight">\(\varPsi_{\alpha}(t+k\Delta t,j,k)\)</span>, respectively. One easily verifies that</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-11">
<span class="eqno">(1.16)<a class="headerlink" href="#equation-theory-turbulent-inflow-11" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
\left\langle \Psi_{\alpha,0}\Psi_{\alpha,k} \right\rangle &amp;= \left\langle \Psi_{\alpha,0}\left\{\Psi_{\alpha,k-1}\left(-\frac{\pi \Delta t}{2T} \right)+ \varPsi_{\alpha,k-1}\left[1-\mathrm{exp}\left(-\frac{\pi \Delta t}{T} \right)\right]^{0.5}\right\}\right\rangle \\
&amp; = \left\langle \Psi_{\alpha,0} \Psi_{\alpha,k-1} \right\rangle \mathrm{exp}\left(-\frac{\pi \Delta t}{2T}\right) \\
&amp; \cdots \\
&amp; = \mathrm{exp}\left(-\frac{k\pi \Delta t}{2T}\right)
\end{split}\end{split}\]</div>
<p>which reproduces an exponential function. An overall algorithm for generating the inflow velocity supported by the method of <a class="bibtex reference internal" href="#xie2008" id="id24">[1]</a> can be stated as follows</p>
<ol class="loweralpha simple">
<li><p>Choose for each coordinate direction corresponding to the inflow plane a length scale <span class="math notranslate nohighlight">\(L_{22} = n_2\Delta x_2\)</span>, <span class="math notranslate nohighlight">\(L_{33} = n_3\Delta x_3\)</span>, a time scale <span class="math notranslate nohighlight">\(T\)</span> and determine the filter width <span class="math notranslate nohighlight">\(N_{\alpha}\)</span> (<span class="math notranslate nohighlight">\(\alpha =1,2,3\)</span>) accordingly.</p></li>
<li><p>Initialize and store three random fields <span class="math notranslate nohighlight">\(R_{\alpha}\)</span> (again <span class="math notranslate nohighlight">\(\alpha =1,2,3\)</span>) of dimensions <span class="math notranslate nohighlight">\([-N_2+1:M_2+N_2,-N_3+1:M_3+N_3]\)</span> where <span class="math notranslate nohighlight">\(M_2 \times M_3\)</span> denotes the dimensions of computational gird in the inflow plane.</p></li>
<li><p>Compute the filter coefficients <span class="math notranslate nohighlight">\(b(j,k)\)</span> with a prescribed function or by a multidimensional Newton method such that the resulting correlation function meet the target one.</p></li>
<li><p>Applying the following filter operations for <span class="math notranslate nohighlight">\(j=1,\ldots,M_2\)</span>, <span class="math notranslate nohighlight">\(k=1,\ldots,M_3\)</span></p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-12">
<span class="eqno">(1.17)<a class="headerlink" href="#equation-theory-turbulent-inflow-12" title="Permalink to this equation">¶</a></span>\[\varPsi_{\alpha}(j,k) = \sum_{j'=-N_2}^{N_2}\sum_{k'=-N_3}^{N_3}b(j',k')R_{\alpha}(j+j',k+k')\]</div>
<p>which yields the two-dimensional arrays of spatially correlated data <span class="math notranslate nohighlight">\(\varPsi_{\alpha}\)</span>, <span class="math notranslate nohighlight">\(\alpha =1,2,3\)</span>.</p>
<ol class="loweralpha simple" start="5">
<li><p>Compute <span class="math notranslate nohighlight">\(\Psi_{\alpha}(j,k)\)</span> with <a class="reference internal" href="#equation-temporalcorrelation">(1.15)</a> and output the velocity signal with the transformation</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-13">
<span class="eqno">(1.18)<a class="headerlink" href="#equation-theory-turbulent-inflow-13" title="Permalink to this equation">¶</a></span>\[u_i(j,k) = U_i + a_{ij}\Psi_j(j,k)\]</div>
<p>where the coefficients <span class="math notranslate nohighlight">\(a_{ij}\)</span> are given by <a class="reference internal" href="#equation-lundcoefficients">(1.23)</a>. Again, this step ensures the synthetic velocity reproduces the target mean velocity and Reynolds stress tensor.</p>
<ol class="loweralpha simple" start="6">
<li><p>Repeat the steps (d) <span class="math notranslate nohighlight">\(\sim\)</span> (f) for each time step.</p></li>
</ol>
</div>
<div class="section" id="synthetic-eddy-method">
<span id="sectionsem"></span><h2><span class="section-number">1.4. </span>Synthetic Eddy Method<a class="headerlink" href="#synthetic-eddy-method" title="Permalink to this headline">¶</a></h2>
<p>The synthetic eddy method (SEM) initiated by <a class="bibtex reference internal" href="#jarrin2006" id="id25">[2]</a> is based on the classical view of turbulence as a superposition of the representative coherent eddies. In the SEM, the flow is assumed to consist of randomly distributed turbulent spots, and each turbulent spot is modelled by a three-dimensional shape function with compact support and satisfies a proper normalization condition. The spots are then assumed to be convected through an inlet plane with a reference velocity using Taylor’s frozen turbulence hypothesis. The resulting inflow turbulence is then reconstructed using the method proposed by to recover the desired statistical characteristics and to account for the conditions of inhomogeneity and anisotropy. The choice of the shape function plays an important role in the SEM since it is directly related to the two-point auto-correlation function, and consequently the power spectrum of the synthetic turbulence. Enforcement of the continuity condition in the SEM was discussed in <a class="bibtex reference internal" href="#poletto2013" id="id26">[3]</a> which will be introduced later.</p>
<p>A brief introduction on the SEM presented by <a class="bibtex reference internal" href="#jarrin2006" id="id27">[2]</a> is given as follows. To start with, the turbulent spot mentioned above can be represented as eddies defined by shape function <span class="math notranslate nohighlight">\(f\)</span> which has a compact support on <span class="math notranslate nohighlight">\([-1,1]\)</span> and has the normalization</p>
<div class="math notranslate nohighlight" id="equation-normalization">
<span class="eqno">(1.19)<a class="headerlink" href="#equation-normalization" title="Permalink to this equation">¶</a></span>\[\int_{-1}^1 f^2(x) \mathrm{d}x = 1\]</div>
<p>The inflow plane on which we want to generate the synthetic turbulence with the SEM is basically a finite set of points <span class="math notranslate nohighlight">\(S = \{\mathbf{x}_1,\mathbf{x}_2,\ldots,\mathbf{x}_s\}\)</span>. The first step is to create a box of eddies <span class="math notranslate nohighlight">\(B\)</span> surrounding <span class="math notranslate nohighlight">\(S\)</span> which is going to contain the synthetic eddies. It is defined by</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-14">
<span class="eqno">(1.20)<a class="headerlink" href="#equation-theory-turbulent-inflow-14" title="Permalink to this equation">¶</a></span>\[B = \big\{(x_1,x_2,x_3)\in \mathbb{R}^3: x_{i,\text{min}}&lt;x_i&lt;x_{i,\text{max}}\big\}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-15">
<span class="eqno">(1.21)<a class="headerlink" href="#equation-theory-turbulent-inflow-15" title="Permalink to this equation">¶</a></span>\[x_{i,\text{min}} = \text{min}(x_i-\sigma_i(\mathbf{x})), \quad x_{i,\text{max}} = \text{max}(x_i+\sigma_i(\mathbf{x})), \quad \mathbf{x}\in S\]</div>
<p>The volume of the box of eddies is noted by <span class="math notranslate nohighlight">\(V_B\)</span>. In the synthetic eddy method, the velocity signal generated by <span class="math notranslate nohighlight">\(N\)</span> eddies has the representation</p>
<div class="math notranslate nohighlight" id="equation-semvelocity">
<span class="eqno">(1.22)<a class="headerlink" href="#equation-semvelocity" title="Permalink to this equation">¶</a></span>\[u_i(\mathbf{x}) = U_i(\mathbf{x}) + \frac{1}{\sqrt{N}}\sum_{k=1}^N a_{ij} \epsilon_j^k f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> represent the coordinates of computational points and <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> represent the coordinates of eddies. The coefficient <span class="math notranslate nohighlight">\(a_{ij}\)</span> results from the Cholesky decomposition of a prescribed Reynolds stress tensor <span class="math notranslate nohighlight">\(R_{ij}\)</span></p>
<div class="math notranslate nohighlight" id="equation-lundcoefficients">
<span class="eqno">(1.23)<a class="headerlink" href="#equation-lundcoefficients" title="Permalink to this equation">¶</a></span>\[\begin{split}\left(\begin{matrix}
\sqrt{R_{11}} &amp; 0 &amp; 0 \\
R_{21}/a_{11} &amp; \sqrt{R_{22}-a_{21}^2} &amp; 0 \\
R_{31}/a_{11}  &amp; (R_{32}-a_{21}a_{31})/a_{22} &amp; \sqrt{R_{33}-a_{31}^2--a_{32}^2}
\end{matrix}\right)\end{split}\]</div>
<p>The coefficient <span class="math notranslate nohighlight">\(\epsilon_j^k\)</span> (<span class="math notranslate nohighlight">\(j=1,2,3\)</span>) is is the uniformly random intensity factor of values <span class="math notranslate nohighlight">\(+1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span>, and <span class="math notranslate nohighlight">\(f_{\mathbf{\sigma}(\mathbf{x})} (\mathbf{x}-\mathbf{x}^k)\)</span> is the velocity distribution at <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> of the eddy located at <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> defined as follows:</p>
<div class="math notranslate nohighlight" id="equation-eddytype">
<span class="eqno">(1.24)<a class="headerlink" href="#equation-eddytype" title="Permalink to this equation">¶</a></span>\[f_{\mathbf{\sigma}(\mathbf{x})} (\mathbf{x}-\mathbf{x}^k) = \sqrt{\frac{V_B}{\sigma_1\sigma_2\sigma_3}}f\left(\frac{x_1-x_1^k}{\sigma_1}\right)f\left(\frac{x_2-x_2^k}{\sigma_2}\right)f\left(\frac{x_3-x_3^k}{\sigma_3}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\sigma}=(\sigma_1,\sigma_2,\sigma_3)^T\)</span>. The position of the eddies <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> before the first time step are independent from each other and taken from a uniform distribution over the box of eddies <span class="math notranslate nohighlight">\(B\)</span>. The eddies are convected through the box of eddies <span class="math notranslate nohighlight">\(B\)</span> with the mean velocity <span class="math notranslate nohighlight">\(\mathbf{U}(\mathbf{x})\)</span>. At each time step, the new position of eddy <span class="math notranslate nohighlight">\(k\)</span> is given by</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-16">
<span class="eqno">(1.25)<a class="headerlink" href="#equation-theory-turbulent-inflow-16" title="Permalink to this equation">¶</a></span>\[\mathbf{x}^k(t+\Delta t) = \mathbf{x}^k(t)+\mathbf{U}(\mathbf{x}^k)\Delta t\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta t\)</span> is the time step of the simulation. If an eddy <span class="math notranslate nohighlight">\(k\)</span> is convected out of the box <span class="math notranslate nohighlight">\(B\)</span>, then it is immediately regenerated randomly with in the region</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-17">
<span class="eqno">(1.26)<a class="headerlink" href="#equation-theory-turbulent-inflow-17" title="Permalink to this equation">¶</a></span>\[B_{\Delta t} = \left\{ \mathbf{x}\notin B, \ \mathbf{x}+\mathbf{U}(\mathbf{x})\Delta t \in B \right\}\]</div>
<p>with a new random intensity vector <span class="math notranslate nohighlight">\(\epsilon_j^k\)</span>. <span class="math notranslate nohighlight">\(B_{\Delta t}\)</span> denotes the region in which regenerated eddy <span class="math notranslate nohighlight">\(\mathbf{x}^k(t) \in B_{\Delta t}\)</span> dose not effect the synthetic velocity at the inflow plane until the next time-step.</p>
<div class="section" id="mean-flow-and-reynolds-stresses">
<h3>Mean Flow and Reynolds Stresses<a class="headerlink" href="#mean-flow-and-reynolds-stresses" title="Permalink to this headline">¶</a></h3>
<p>The mean value of the velocity signal <a class="reference internal" href="#equation-semvelocity">(1.22)</a> can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-18">
<span class="eqno">(1.27)<a class="headerlink" href="#equation-theory-turbulent-inflow-18" title="Permalink to this equation">¶</a></span>\[\left\langle u_i \right\rangle = U_i(\mathbf{x}) + \frac{1}{\sqrt{N}}\sum_{k=1}^N \left\langle a_{ij} \varepsilon_j^k f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k) \right\rangle\]</div>
<p>where the angles denote the mean operator. The independence between the random variables <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_j^k\)</span> in the mean operator implies that</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-19">
<span class="eqno">(1.28)<a class="headerlink" href="#equation-theory-turbulent-inflow-19" title="Permalink to this equation">¶</a></span>\[\left\langle a_{ij} \varepsilon_j^k f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k) \right\rangle = a_{ij} \left\langle\varepsilon_j^k\right\rangle  \left\langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k)  \right\rangle\]</div>
<p>The term <span class="math notranslate nohighlight">\(\langle\varepsilon_j^k\rangle = 0\)</span> since the intensities of the eddies is either <span class="math notranslate nohighlight">\(1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span> with equal probability. Consequently, we obtain</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-20">
<span class="eqno">(1.29)<a class="headerlink" href="#equation-theory-turbulent-inflow-20" title="Permalink to this equation">¶</a></span>\[\left\langle u_i \right\rangle = U_i(\mathbf{x}).\]</div>
<p>The Reynolds stresses <span class="math notranslate nohighlight">\(\langle u_i u_j \rangle\)</span> of the synthesized write</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-21">
<span class="eqno">(1.30)<a class="headerlink" href="#equation-theory-turbulent-inflow-21" title="Permalink to this equation">¶</a></span>\[\langle u_i u_j \rangle = \frac{1}{N}\sum_{k=1}^N\sum_{k=1}^N a_{im}a_{jn} \langle \varepsilon_m^k \varepsilon_n^l \rangle \langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k) f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^l) \rangle\]</div>
<p>Using again the independence between the random variables <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_j^k\)</span>, the above equation reduces to</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-22">
<span class="eqno">(1.31)<a class="headerlink" href="#equation-theory-turbulent-inflow-22" title="Permalink to this equation">¶</a></span>\[\langle u_i u_j \rangle = \frac{1}{N}\sum_{k=1}^N a_{im}a_{jm} \langle f_{\mathbf{\sigma}(\mathbf{x})}^2(\mathbf{x}-\mathbf{x}^k)\]</div>
<p>The term</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-23">
<span class="eqno">(1.32)<a class="headerlink" href="#equation-theory-turbulent-inflow-23" title="Permalink to this equation">¶</a></span>\[\langle f_{\mathbf{\sigma}(\mathbf{x})}^2(\mathbf{x}-\mathbf{x}^k) \rangle = \int_{\mathbb{R}^3} p(\mathbf{y}) f_{\mathbf{\sigma}(\mathbf{x})}^2(\mathbf{x}-\mathbf{x}^k) = 1\]</div>
<p>follows from the fact that <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> follows a uniform distribution over <span class="math notranslate nohighlight">\(B\)</span>, i.e.</p>
<div class="math notranslate nohighlight" id="equation-distribution">
<span class="eqno">(1.33)<a class="headerlink" href="#equation-distribution" title="Permalink to this equation">¶</a></span>\[\begin{split}p(\mathbf{y}) =
\begin{cases}
\frac{1}{V_B} &amp; \mathbf{y} \in B \\
0 &amp; \mathbf{y} \notin B
\end{cases}.\end{split}\]</div>
<p>Finally, we arrive at</p>
<div class="math notranslate nohighlight" id="equation-reynoldsstresses">
<span class="eqno">(1.34)<a class="headerlink" href="#equation-reynoldsstresses" title="Permalink to this equation">¶</a></span>\[\langle u_i u_j \rangle = \frac{1}{N}\sum_{k=1}^N a_{im}a_{jm} = R_{ij}\]</div>
<p>Hence the Reynolds stresses of the velocity fluctuations generated by the SEM reproduce exactly the input Reynolds stresses.</p>
</div>
<div class="section" id="two-point-correlation">
<h3>Two-point Correlation<a class="headerlink" href="#two-point-correlation" title="Permalink to this headline">¶</a></h3>
<p>The two-point cross-correlation of the velocity fluctuations writes</p>
<div class="math notranslate nohighlight" id="equation-twopointcorrelations0">
<span class="eqno">(1.35)<a class="headerlink" href="#equation-twopointcorrelations0" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\mathbf{r}) = \langle u_i(\mathbf{x},t) u_j(\mathbf{x}+\mathbf{r},t) \rangle\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{r} = (r_1,r_2,r_3)\)</span> is a vector defining the relative positions between the two points at which the velocity correlations are computed. By <a class="reference internal" href="#equation-semvelocity">(1.22)</a> and the linearity of the statistical mean, we obtain</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-24">
<span class="eqno">(1.36)<a class="headerlink" href="#equation-theory-turbulent-inflow-24" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\mathbf{r}) = \frac{1}{N}\sum_{k=1}^N\sum_{k=1}^N a_{im}a_{jn} \langle \varepsilon_m^k \varepsilon_n^l \rangle \langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k) f_{\mathbf{\sigma}(\mathbf{x}+\mathbf{r})}(\mathbf{x}+\mathbf{r}-\mathbf{x}^l) \rangle\]</div>
<p>Using again the independence between the positions <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> and the intensities <span class="math notranslate nohighlight">\(\varepsilon^k\)</span> of the eddies, this yields</p>
<div class="math notranslate nohighlight" id="equation-twopointcorrelations1">
<span class="eqno">(1.37)<a class="headerlink" href="#equation-twopointcorrelations1" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\mathbf{r}) = \frac{1}{N}\sum_{k=1}^N a_{im}a_{jm} \langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k) f_{\mathbf{\sigma}(\mathbf{x}+\mathbf{r})}(\mathbf{x}+\mathbf{r}-\mathbf{x}^k) \rangle\]</div>
<p>By <a class="reference internal" href="#equation-distribution">(1.33)</a>, the term in the mean operator writes</p>
<div class="math notranslate nohighlight" id="equation-twopointcorrelations2">
<span class="eqno">(1.38)<a class="headerlink" href="#equation-twopointcorrelations2" title="Permalink to this equation">¶</a></span>\[\langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k) f_{\mathbf{\sigma}(\mathbf{x}+\mathbf{r})}(\mathbf{x}+\mathbf{r}-\mathbf{x}^k) \rangle = \frac{1}{V_B} \int_B f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{y}) f_{\mathbf{\sigma}(\mathbf{x}+\mathbf{r})}(\mathbf{x}+\mathbf{r}-\mathbf{y}) \mathrm{d}\mathbf{y}\]</div>
<p>Inserting <a class="reference internal" href="#equation-twopointcorrelations2">(1.38)</a> back to <a class="reference internal" href="#equation-twopointcorrelations1">(1.37)</a> and using <a class="reference internal" href="#equation-eddytype">(1.24)</a>, this yields</p>
<div class="math notranslate nohighlight" id="equation-twopointcorrelations3">
<span class="eqno">(1.39)<a class="headerlink" href="#equation-twopointcorrelations3" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\mathbf{r}) = R_{ij} \cdot \prod_{l=1}^3 \left[f_{\mathbf{\sigma}(\mathbf{x})} *f_{\mathbf{\sigma}(\mathbf{x}+\mathbf{r})} \right](r_l)\]</div>
<p>where <span class="math notranslate nohighlight">\(*\)</span> denotes the convolution product. For homogeneous turbulence where integral length scales <span class="math notranslate nohighlight">\(\mathbf{\sigma}(\mathbf{x}) = \mathbf{\sigma}(\mathbf{x}+\mathbf{r}) =(\sigma,\sigma,\sigma)^T\)</span>, the two-point cross-correlation tensor <span class="math notranslate nohighlight">\(R_{ij}(\mathbf{x},\mathbf{r})\)</span> only depends on <span class="math notranslate nohighlight">\(\mathbf{r}\)</span> and consequently <a class="reference internal" href="#equation-twopointcorrelations3">(1.39)</a> simplifies to</p>
<div class="math notranslate nohighlight" id="equation-twopointcorrelations4">
<span class="eqno">(1.40)<a class="headerlink" href="#equation-twopointcorrelations4" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{r}) = R_{ij} \cdot \prod_{l=1}^3 \left[f*f\right]\left(\frac{r_l}{\sigma}\right)\]</div>
<p>Recall the integral length scale <span class="math notranslate nohighlight">\(L_{ij}\)</span> is defined as the integral of the two-point correlation <span class="math notranslate nohighlight">\(R_{ij}(\mathbf{x},\mathbf{r})\)</span> in a particular direction and is thus proportional to <span class="math notranslate nohighlight">\(\sigma\)</span>. By integrating <a class="reference internal" href="#equation-twopointcorrelations4">(1.40)</a>, one easily verifies that (for homogeneous turbulence) <span class="math notranslate nohighlight">\(L_{ij}=C_f\sigma\)</span> in every direction where <span class="math notranslate nohighlight">\(C_f\)</span> only depends on the choice of <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>Fourier analysis can also be used to obtain the spectra of the synthetic turbulence. Note that the velocity spectrum tensor <span class="math notranslate nohighlight">\(\phi_{ij}(k)\)</span> is the Fourier transform of the two-point correlation tensor</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-25">
<span class="eqno">(1.41)<a class="headerlink" href="#equation-theory-turbulent-inflow-25" title="Permalink to this equation">¶</a></span>\[\phi_{ij}(\mathbf{k}) = \mathcal{F}_{\mathbf{k}}\left\{R_{ij}(\mathbf{r})\right\}\]</div>
<p>Recall the convolution theorem for cross-correlation states that</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-26">
<span class="eqno">(1.42)<a class="headerlink" href="#equation-theory-turbulent-inflow-26" title="Permalink to this equation">¶</a></span>\[\mathcal{F}_{\mathbf{k}}\left\{f * f\right\} = |\mathcal{F}_{\mathbf{k}}\left\{f\right\}|^2\]</div>
<p>Hence the spatial velocity spectrum tensor can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-27">
<span class="eqno">(1.43)<a class="headerlink" href="#equation-theory-turbulent-inflow-27" title="Permalink to this equation">¶</a></span>\[\phi_{ij}(\mathbf{k}) = R_{ij}\sigma^3 \cdot \prod_{l=1}^3|\mathcal{F}_{k_l\sigma}\left\{f\right\}|^2\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{k} = (k_1,k_2,k_3)\)</span>. More specifically for instance, the one-dimensional spectra in the <span class="math notranslate nohighlight">\(x\)</span> direction is</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-28">
<span class="eqno">(1.44)<a class="headerlink" href="#equation-theory-turbulent-inflow-28" title="Permalink to this equation">¶</a></span>\[E_{ij}(k) = R_{ij}\sigma^3 \cdot |\mathcal{F}_{k_l\sigma}\left\{f\right\}|^2\]</div>
</div>
<div class="section" id="two-time-correlation">
<h3>Two-time Correlation<a class="headerlink" href="#two-time-correlation" title="Permalink to this headline">¶</a></h3>
<p>The two-time correlation tensor of the velocity, denoted by <span class="math notranslate nohighlight">\(R_{ij}(\mathbf{x},\tau)\)</span>, is the correlation between <span class="math notranslate nohighlight">\(u_i(\mathbf{x},t)\)</span> and <span class="math notranslate nohighlight">\(u_j(\mathbf{x},t+\tau)\)</span> at times <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(t+\tau\)</span> respectively, i.e.,</p>
<div class="math notranslate nohighlight" id="equation-twotimecorrelation0">
<span class="eqno">(1.45)<a class="headerlink" href="#equation-twotimecorrelation0" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\tau) = \langle u_i(\mathbf{x},t) u_j(\mathbf{x},t+\tau) \rangle.\]</div>
<p>By <a class="reference internal" href="#equation-semvelocity">(1.22)</a> and the linearity of the statistical mean, we have</p>
<div class="math notranslate nohighlight" id="equation-twotimecorrelation1">
<span class="eqno">(1.46)<a class="headerlink" href="#equation-twotimecorrelation1" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\tau) = \frac{1}{N}\sum_{k=1}^N\sum_{k=1}^N a_{im}a_{jn} \langle \varepsilon_m^k(t) \varepsilon_n^l(t+\tau) f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k(t)) f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^l(t+\tau)) \rangle\]</div>
<p>The independence between the position <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span> and intensity <span class="math notranslate nohighlight">\(\varepsilon_m^k\)</span> of different eddies implies that, for <span class="math notranslate nohighlight">\(k \neq l\)</span>, the statistical mean in <a class="reference internal" href="#equation-twotimecorrelation1">(1.46)</a> can be split as follows</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-29">
<span class="eqno">(1.47)<a class="headerlink" href="#equation-theory-turbulent-inflow-29" title="Permalink to this equation">¶</a></span>\[\langle \varepsilon_m^k(t) \rangle \langle \varepsilon_n^l(t+\tau) \rangle \langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k(t)) \rangle \langle f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^l(t+\tau)) \rangle = 0\]</div>
<p>Consequently <a class="reference internal" href="#equation-twotimecorrelation1">(1.46)</a> reduces to</p>
<div class="math notranslate nohighlight" id="equation-twotimecorrelation2">
<span class="eqno">(1.48)<a class="headerlink" href="#equation-twotimecorrelation2" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\tau) = \frac{1}{N}\sum_{k=1}^N a_{im}a_{jn} \langle \varepsilon_m^k(t) \varepsilon_n^k(t+\tau) f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k(t)) f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{x}^k(t+\tau)) \rangle\]</div>
<p>Before computing the term in the angles, we define <span class="math notranslate nohighlight">\(B_{\tau} \in B\)</span>  such that all eddies that present in <span class="math notranslate nohighlight">\(B_{\tau}\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> will be convected far enough so that they will be recycled at least once before time <span class="math notranslate nohighlight">\(t+\tau\)</span></p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-30">
<span class="eqno">(1.49)<a class="headerlink" href="#equation-theory-turbulent-inflow-30" title="Permalink to this equation">¶</a></span>\[B_{\tau} = \left\{\mathbf{x}\in B, \ \mathbf{x}+\tau \mathbf{U}(\mathbf{x}) \in B \right\}\]</div>
<p>If <span class="math notranslate nohighlight">\(\mathbf{x}^k(t)\in B_{\tau}\)</span>, then it is going to be recycled between time <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(t+\tau\)</span> and hence both <span class="math notranslate nohighlight">\(\mathbf{x}^k(t+\tau)\)</span> and <span class="math notranslate nohighlight">\(\varepsilon_m^k(t+\tau)\)</span> will be independent of their previous values. The contribution of an eddy <span class="math notranslate nohighlight">\(k\)</span> located within the region where <span class="math notranslate nohighlight">\(\mathbf{x}^k(t) \in B_{\tau}\)</span> to the term in the angles of <a class="reference internal" href="#equation-twotimecorrelation2">(1.48)</a> is thus zero. On the contrary if <span class="math notranslate nohighlight">\(\mathbf{x}^k(t) \in B_{\tau}\)</span>, the eddy <span class="math notranslate nohighlight">\(k\)</span> will remain inside of the box <span class="math notranslate nohighlight">\(B\)</span> at time <span class="math notranslate nohighlight">\(t + \tau\)</span> and hence <span class="math notranslate nohighlight">\(\varepsilon_m^k(t+\tau) =  \varepsilon_m^k(t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}^k(t+\tau) =\mathbf{x}^k(t)+\tau\mathbf{U}(\mathbf{x}^k)\)</span>. Thus both <span class="math notranslate nohighlight">\(\varepsilon_n^k(t+\tau) =  \varepsilon_n^k(t)\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}^k(t+\tau)\)</span> depend on the previous position <span class="math notranslate nohighlight">\(\mathbf{x}^k(t)\)</span> of eddy <span class="math notranslate nohighlight">\(k\)</span> relative to <span class="math notranslate nohighlight">\(B_{\tau}\)</span>. By <a class="reference internal" href="#equation-reynoldsstresses">(1.34)</a> and the definition of <span class="math notranslate nohighlight">\(B_{\tau}\)</span>, <a class="reference internal" href="#equation-twopointcorrelations0">(1.35)</a> can then be replaced by</p>
<div class="math notranslate nohighlight" id="equation-twotimecorrelation3">
<span class="eqno">(1.50)<a class="headerlink" href="#equation-twotimecorrelation3" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\tau) = R_{ij} \int_{B/B_{\tau}}f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{y}) f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-(\mathbf{y}+\tau\mathbf{U}_c)) \ \mathrm{d}\mathbf{y}\]</div>
<p>The condition <span class="math notranslate nohighlight">\(\mathbf{y}\in B_{\tau}\)</span> leads to <span class="math notranslate nohighlight">\(f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-(\mathbf{y}+\tau\mathbf{U}))=0\)</span>. Thus, the integral over <span class="math notranslate nohighlight">\(B/B_{\tau}\)</span> in <a class="reference internal" href="#equation-twopointcorrelations3">(1.39)</a> can be extended to an integral over <span class="math notranslate nohighlight">\(B\)</span>. Besides <span class="math notranslate nohighlight">\(\mathbf{y}\in B\)</span> suggests <span class="math notranslate nohighlight">\(f_{\mathbf{\sigma}(\mathbf{x})}(\mathbf{x}-\mathbf{y})=0\)</span> as previously demonstrated, therefore the integral in <a class="reference internal" href="#equation-twotimecorrelation3">(1.50)</a> can be further extended to an integral over <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>. Using <a class="reference internal" href="#equation-eddytype">(1.24)</a>, this yields</p>
<div class="math notranslate nohighlight" id="equation-twotimecorrelation4">
<span class="eqno">(1.51)<a class="headerlink" href="#equation-twotimecorrelation4" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\tau) = R_{ij} \cdot \prod_{l=1}^3[f*f]\left(\frac{\tau U_{l}(\mathbf{x})}{\sigma_l(\mathbf{x})}\right)\]</div>
<p>In the case where the mean velocity is in the <span class="math notranslate nohighlight">\(x_1\)</span>-direction only <span class="math notranslate nohighlight">\(\mathbf{U} = (U,0,0)\)</span> and the target turbulence is homogeneous, <a class="reference internal" href="#equation-twotimecorrelation4">(1.51)</a> simplifies to</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-31">
<span class="eqno">(1.52)<a class="headerlink" href="#equation-theory-turbulent-inflow-31" title="Permalink to this equation">¶</a></span>\[R_{ij}(\mathbf{x},\tau) = R_{ij} [f*f]\left(\frac{\tau U(\mathbf{x})}{\sigma(\mathbf{x})}\right)\]</div>
<p>Thus, the two-time correlation of the signal at time <span class="math notranslate nohighlight">\(\tau\)</span> is simply the auto-correlation function of <span class="math notranslate nohighlight">\(f\)</span> at separation distance <span class="math notranslate nohighlight">\(\tau U /\sigma\)</span>. By integrating the above equation it can be proved that the integral time scale of the signal writes <span class="math notranslate nohighlight">\(T = \sigma/U C_f\)</span> where <span class="math notranslate nohighlight">\(C_f\)</span> is a coefficient only depends on the choice of <span class="math notranslate nohighlight">\(f\)</span>. Since the synthetic velocity is a stationary process, the information the two-time cross-correlation tensor <span class="math notranslate nohighlight">\(R_{ij}(\mathbf{x},\tau)\)</span> contains can be re-expressed in terms of the wave number velocity spectrum tensor which writes</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-32">
<span class="eqno">(1.53)<a class="headerlink" href="#equation-theory-turbulent-inflow-32" title="Permalink to this equation">¶</a></span>\[\phi_{ij}(\mathbf{x},\omega) = \mathcal{F}_{\omega}\{R_{ij}(\mathbf{x},\tau)\}\]</div>
<p>Using again the convolution theorem, the above expression simplifies to</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-33">
<span class="eqno">(1.54)<a class="headerlink" href="#equation-theory-turbulent-inflow-33" title="Permalink to this equation">¶</a></span>\[\phi_{ij}(\mathbf{x},\omega) = R_{ij}\frac{\sigma}{|U|} |\mathcal{F}_{\omega\sigma / |U|}\{f\}|^2\]</div>
</div>
<div class="section" id="commonly-used-velocity-shape-functions">
<h3>Commonly Used Velocity Shape Functions<a class="headerlink" href="#commonly-used-velocity-shape-functions" title="Permalink to this headline">¶</a></h3>
<p>The three commonly used velocity shape functions for <span class="math notranslate nohighlight">\(f\)</span> are given below for reference which are the tent function, the step function and the truncated Gaussian function.</p>
<ul class="simple">
<li><p>Tent function</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-ftent">
<span class="eqno">(1.55)<a class="headerlink" href="#equation-ftent" title="Permalink to this equation">¶</a></span>\[\begin{split}f(x) =
\begin{cases}
\sqrt{\frac{3}{2}}(1-|x|), &amp; 0 \leq |x| &lt; 1 \\
0, &amp; |x| \geq 1
\end{cases}\end{split}\]</div>
<p>which yields</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-34">
<span class="eqno">(1.56)<a class="headerlink" href="#equation-theory-turbulent-inflow-34" title="Permalink to this equation">¶</a></span>\[\begin{split}[f*f](r) =
\begin{cases}
1-\frac{3}{2}r^2+\frac{3}{4}|r|^3, &amp; 0 \leq |r| &lt; 1 \\
2-3|r|+\frac{3}{2}r^2-\frac{1}{4}|r|^3, &amp; 1 \leq |r| &lt;2 \\
0, &amp; |r|\geq 2
\end{cases}\end{split}\]</div>
<ul class="simple">
<li><p>Step function</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-fstep">
<span class="eqno">(1.57)<a class="headerlink" href="#equation-fstep" title="Permalink to this equation">¶</a></span>\[\begin{split}f(x) =
\begin{cases}
\frac{1}{\sqrt{2}}, &amp; 0 \leq |x| &lt; 1 \\
0, &amp; |x| \geq 1
\end{cases}\end{split}\]</div>
<p>which yields</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-35">
<span class="eqno">(1.58)<a class="headerlink" href="#equation-theory-turbulent-inflow-35" title="Permalink to this equation">¶</a></span>\[\begin{split}[f*f](r) =
\begin{cases}
1-\frac{|r|}{2}, &amp; 0 \leq |r| &lt; 2 \\
0, &amp; |r|\geq 2
\end{cases}\end{split}\]</div>
<ul class="simple">
<li><p>Truncated Gaussian function</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-fgaussian">
<span class="eqno">(1.59)<a class="headerlink" href="#equation-fgaussian" title="Permalink to this equation">¶</a></span>\[\begin{split}f(x) =
\begin{cases}
Ce^{-9x^2/2}, &amp; 0 \leq |x| &lt; 1 \\
0, &amp; |x| \geq 1
\end{cases}\end{split}\]</div>
<p>which yields</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-36">
<span class="eqno">(1.60)<a class="headerlink" href="#equation-theory-turbulent-inflow-36" title="Permalink to this equation">¶</a></span>\[\begin{split}[f*f](r) =
\begin{cases}
e^{-9r^2/4} &amp; 0\leq |r| &lt; 2 \\
0, &amp; |r|\geq 2
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is a constant that ensures <span class="math notranslate nohighlight">\(f\)</span> satisfies the normalization <a class="reference internal" href="#equation-normalization">(1.19)</a>.</p>
</div>
</div>
<div class="section" id="divergence-free-synthetic-eddy-method">
<span id="sectiondfsem"></span><h2><span class="section-number">1.5. </span>Divergence Free Synthetic Eddy Method<a class="headerlink" href="#divergence-free-synthetic-eddy-method" title="Permalink to this headline">¶</a></h2>
<p>One route to obtain a divergence free method, as suggested by <a class="bibtex reference internal" href="#poletto2013" id="id28">[3]</a>, is to apply the original SEM methodology to the vorticity field, which is then transformed back to the velocity field by taking the curl of it. One easily verifies that vorticity and velocity fields are linked by the following:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-37">
<span class="eqno">(1.61)<a class="headerlink" href="#equation-theory-turbulent-inflow-37" title="Permalink to this equation">¶</a></span>\[\nabla\times\omega' = \nabla(\nabla\cdot\mathbf{u}')-\nabla^2\mathbf{u}'\]</div>
<p>Because of the hypothesis of incompressible flow, the first term on the right hand side of the above equation vanishes, leading to a Poisson equation for the velocity field. The solution of this Poisson equation, achieved by using the Biot–Savart kernel, leads to the fluctuating velocity field expressed as:</p>
<div class="math notranslate nohighlight" id="equation-dfsemvelocity">
<span class="eqno">(1.62)<a class="headerlink" href="#equation-dfsemvelocity" title="Permalink to this equation">¶</a></span>\[\mathbf{u}'(\mathbf{x}) = \sqrt{\frac{1}{N}}\sum_{k=1}^N\frac{q_{\sigma}(|\mathbf{r}^k|)}{|\mathbf{r}^k|}\mathbf{r}^k\times\alpha^k\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{r}^k=(\mathbf{x}-\mathbf{x}^k)/\sigma^k\)</span>, <span class="math notranslate nohighlight">\(q_{\sigma}(|\mathbf{r}^k|)\)</span> is a suitable shape function and <span class="math notranslate nohighlight">\(\alpha_i^k\)</span> are random numbers with zero average which represent the eddy intensities.</p>
<p>Despite the similarities between <a class="reference internal" href="#equation-semvelocity">(1.22)</a> and <a class="reference internal" href="#equation-dfsemvelocity">(1.62)</a>, i.e. both including a user defined shape function and a random level eddy intensity, the lack of Lund coefficients in the second formulation poses a significant problem. Their role in the original SEM was crucial in order to allow any given turbulence state to be generated, however, they cannot be re-introduced to <a class="reference internal" href="#equation-dfsemvelocity">(1.62)</a> without forgoing the divergence free condition.</p>
<p>In order to increase the turbulence anisotropy reproduction capabilities, the method presented by <a class="bibtex reference internal" href="#poletto2013" id="id29">[3]</a> employs the formulation of <a class="reference internal" href="#equation-dfsemvelocity">(1.62)</a>, but with an anisotropic length-scale, <span class="math notranslate nohighlight">\(\sigma_i\)</span>, employed in each of the coordinate directions, and allows a different shape function to be associated with each direction. However, such a form no longer automatically satisfies the divergence-free condition ensured by <a class="reference internal" href="#equation-dfsemvelocity">(1.62)</a>, and further constraints on the shape functions need to be considered in order to retain a divergence-free field.  <a class="bibtex reference internal" href="#poletto2013" id="id30">[3]</a> redefine the shape functions to be of the form <span class="math notranslate nohighlight">\(q_{sigma}=q|\mathbf{r}^k|^3\)</span> where <span class="math notranslate nohighlight">\(q\)</span> is a function which depends on the locations <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}^k\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{r}^k\)</span> differs slightly from its previous definition, as it now takes into account the length-scale anisotropy <span class="math notranslate nohighlight">\(\mathbf{r}_{\beta}^k=(\mathbf{x}_{\beta}-\mathbf{x}_{\beta}^k)/\sigma_{\beta}^k\)</span>. The new general formulation for the velocity fluctuations thus becomes:</p>
<div class="math notranslate nohighlight" id="equation-dfsemvelocity2">
<span class="eqno">(1.63)<a class="headerlink" href="#equation-dfsemvelocity2" title="Permalink to this equation">¶</a></span>\[u_{\beta}'(\mathbf{x}) = \sqrt{\frac{1}{N}}\sum_{k=1}^N q_{\beta}\left(\mathbf{x},\mathbf{x}^k,\sigma^k\right) \epsilon_{\beta j l}r_j^k \alpha_l^k\]</div>
<p>In <a class="reference internal" href="#equation-dfsemvelocity2">(1.63)</a>, the cross product presented in <a class="reference internal" href="#equation-dfsemvelocity">(1.62)</a> has been rewritten using the index notation for tensors, where <span class="math notranslate nohighlight">\(\epsilon_{ijl}\)</span> is the Levi–Civita symbol, and no summation is implied over Greek subscripts. As noted above, with the redefined shape functions, the form of <a class="reference internal" href="#equation-dfsemvelocity2">(1.63)</a> no longer automatically satisfies the divergence-free condition. However, on substituting it into the condition that <span class="math notranslate nohighlight">\(\nabla\cdot\mathbf{u}'=0\)</span>, a sufficient condition for ensuring a divergence-free velocity field can be found as:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-38">
<span class="eqno">(1.64)<a class="headerlink" href="#equation-theory-turbulent-inflow-38" title="Permalink to this equation">¶</a></span>\[r_2^k\frac{\partial q_1}{x_1} = r_1^k\frac{\partial q_2}{x_2},\quad
r_3^k\frac{\partial q_2}{x_2} = r_2^k\frac{\partial q_3}{x_3},\quad
r_1^k\frac{\partial q_3}{x_3} = r_3^k\frac{\partial q_1}{x_1}\]</div>
<p>A simple analytically function for <span class="math notranslate nohighlight">\(q_i\)</span> that satisfies the above restrictions is:</p>
<div class="math notranslate nohighlight" id="equation-qequation">
<span class="eqno">(1.65)<a class="headerlink" href="#equation-qequation" title="Permalink to this equation">¶</a></span>\[\begin{split}q_i =
\begin{cases}
\sigma_i\left[1-(d^k)^2\right], &amp; \text{if } d^k&lt;1 \\
0, &amp; \text{elsewhere}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(d^k = \sqrt{(r_j^k)^2}\)</span>.</p>
<p>The function <span class="math notranslate nohighlight">\(q_i\)</span> with the form <a class="reference internal" href="#equation-qequation">(1.65)</a> is continuous everywhere, but its derivative is not strictly defined for <span class="math notranslate nohighlight">\(d^k=1\)</span>, where it is only possible to define a right or left sided derivative. The above formulation thus defines a divergence-free velocity field everywhere except at the eddy surface (<span class="math notranslate nohighlight">\(d^k=1\)</span>), although this formal omission is not believed to result in serious problems. The expression for the velocity obtained by substituting <a class="reference internal" href="#equation-qequation">(1.65)</a> into <a class="reference internal" href="#equation-dfsemvelocity2">(1.63)</a> can be written as:</p>
<div class="math notranslate nohighlight" id="equation-dfsemvelocity3">
<span class="eqno">(1.66)<a class="headerlink" href="#equation-dfsemvelocity3" title="Permalink to this equation">¶</a></span>\[u_{\beta}'(\mathbf{x}) = \sqrt{\frac{1}{N}}\sum_{k=1}^N \sigma_{\beta}^k\left[1-(d^k)^2\right] \epsilon_{\beta j l}r_j^k \alpha_l^k\]</div>
<p>Time-averaging the product of <a class="reference internal" href="#equation-dfsemvelocity3">(1.66)</a> with itself leads to an expression for the Reynolds stresses, from which one can examine how the prescription of the length-scales, <span class="math notranslate nohighlight">\(\sigma_i^k\)</span>, and intensities, <span class="math notranslate nohighlight">\(\alpha_i^k\)</span>, affect the stress anisotropy associated with the synthetically generated field given by <a class="reference internal" href="#equation-dfsemvelocity3">(1.66)</a>:</p>
<div class="math notranslate nohighlight" id="equation-dfsemtensor">
<span class="eqno">(1.67)<a class="headerlink" href="#equation-dfsemtensor" title="Permalink to this equation">¶</a></span>\[\left&lt;u_{\beta}'u_{\gamma}'\right&gt; = \frac{1}{N}\sum_{k=1}^N\sigma_{\beta}^k\sigma_{\gamma}^k \epsilon_{\beta j l} \epsilon_{\gamma m n}\left&lt;\left\{\left[1-(d^k)^2\right]^2r_j^kr_m^k \right\}\right&gt;\left&lt;\alpha_l^k\alpha_n^k\right&gt;\]</div>
<p>On examining <a class="reference internal" href="#equation-dfsemtensor">(1.67)</a>, it is clear that the eddies are independent of each other, and that their intensities are uncorrelated (so <span class="math notranslate nohighlight">\(\left&lt;\alpha_l^k\alpha_n^k\right&gt;\)</span> for <span class="math notranslate nohighlight">\(l \neq m\)</span>); as such, the predicted shear stresses (<span class="math notranslate nohighlight">\(\left&lt;u_{\beta}'u_{\gamma}'\right&gt;\)</span> for <span class="math notranslate nohighlight">\(\beta\neq\gamma\)</span>) will be zero. In order to overcome this problem, fluctuations in the global coordinate system are computed via a standard rotation transformation of the eddies generated in the local principal axes coordinate system (where the Reynolds stress tensor is diagonal):</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-39">
<span class="eqno">(1.68)<a class="headerlink" href="#equation-theory-turbulent-inflow-39" title="Permalink to this equation">¶</a></span>\[u_i^{G}(\mathbf{x}) = C_1 R_{im}^{P\rightarrow G}u_m^P\]</div>
<p>where <span class="math notranslate nohighlight">\(R_{im}^{P\rightarrow G}\)</span> is the rotation transformation matrix from the principal to the global coordinate system, <span class="math notranslate nohighlight">\(u_i^{P}\)</span> and <span class="math notranslate nohighlight">\(u_i^{G}\)</span> are the velocity fluctuations in the principal axes and global systems respectively, and <span class="math notranslate nohighlight">\(C_1\)</span> is a normalization coefficient required in order to have <span class="math notranslate nohighlight">\(\left&lt;(u_i')^2\right&gt;=1\)</span> when <span class="math notranslate nohighlight">\(\left&lt;(\alpha_l^k)^2\right&gt;=1\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-40">
<span class="eqno">(1.69)<a class="headerlink" href="#equation-theory-turbulent-inflow-40" title="Permalink to this equation">¶</a></span>\[C_1 = \frac{\sqrt{10V_0}\sum_{i=1}^3\sigma_i/3}{\sqrt{N}\prod_{i=1}^3\sigma_i}\mathrm{min}\{\sigma_i\}\]</div>
<p>where <span class="math notranslate nohighlight">\(V_0\)</span> is the eddy box volume. For the normal stresses, the contribution from the <span class="math notranslate nohighlight">\(k\)</span>-th eddy in <a class="reference internal" href="#equation-dfsemtensor">(1.67)</a> thus gives</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-41">
<span class="eqno">(1.70)<a class="headerlink" href="#equation-theory-turbulent-inflow-41" title="Permalink to this equation">¶</a></span>\[\left&lt;u_{\beta}'u_{\beta}'\right&gt;=2C_2\sigma_{\beta}^2\epsilon_{\beta l n}\left&lt;(\alpha_l^k)^2\right&gt;\left&lt;(\alpha_n^k)^2\right&gt;\]</div>
<p>where all the terms not explicitly reported are represented by <span class="math notranslate nohighlight">\(C_2\)</span>. The remaining issue is to choose appropriate length-scales and eddy intensities to ensure the above will return the desired Reynolds stress statistics, over a wide range of stress anisotropy levels. For any choice of length-scale ratios (<span class="math notranslate nohighlight">\(\sigma_1/\sigma_2\)</span> and <span class="math notranslate nohighlight">\(\sigma_1/\sigma_3\)</span>), varying the intensity <span class="math notranslate nohighlight">\(\alpha_l^k\)</span> allows one to reproduce possible turbulence anisotropy states over a particular region of the Lumley triangle. For a given the Reynolds stresses are reproduced by defining the following intensities:</p>
<div class="math notranslate nohighlight" id="equation-dfsemalpha">
<span class="eqno">(1.71)<a class="headerlink" href="#equation-dfsemalpha" title="Permalink to this equation">¶</a></span>\[\left&lt;(\alpha_{\beta}^k)^2\right&gt; = \frac{\lambda_j/\sigma_j^2-2\lambda_{\beta}/\sigma_{\beta}^2}{2C_2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> are the normal stresses in the local principal reference system. Since the right hand side of <a class="reference internal" href="#equation-dfsemalpha">(1.71)</a> must be positive, for any value of <span class="math notranslate nohighlight">\(\Gamma\)</span> it is only possible to reproduce a part of the Lumley triangle. By defining a series of ratios <span class="math notranslate nohighlight">\(\Gamma = \frac{\sigma_1}{\sigma_2} = \frac{\sigma_1}{\sigma_3}\)</span>, each allowing one of the regions of the Lumley triangle to be mapped, the Reynolds stress statistics with a wide range of stress anisotropy levels can be reproduced.</p>
</div>
<div class="section" id="turbulent-spot-method-with-anisotropic-vorton">
<span id="sectionatsm"></span><h2><span class="section-number">1.6. </span>Turbulent Spot Method with Anisotropic Vorton<a class="headerlink" href="#turbulent-spot-method-with-anisotropic-vorton" title="Permalink to this headline">¶</a></h2>
<p>Earlier versions of the synthetic eddy method and the turbulent spot method were only able to produce turbulence which does not obey the continuity constraint in general. This was only possible for special cases (isotropic or near-isotropic turbulence). The work of <a class="bibtex reference internal" href="#kroger2018" id="id31">[4]</a> utilizes another approach for introducing the anisotropy into the turbulent spots, which obeys continuity and allows to reproduce strong levels of anisotropy at the same time. Their approach is basically a continuation of the vorton formulation described in <a class="bibtex reference internal" href="#kornev2007" id="id32">[17]</a>. The generation is performed in the coordinate system <span class="math notranslate nohighlight">\((x_1,x_2,x_3)\)</span> determined by principle axes of the Reynolds stresses. The Reynolds stresses in any other system <span class="math notranslate nohighlight">\((x_1',x_2',x_3')\)</span> are calculated by <span class="math notranslate nohighlight">\(R_{ij}' = E_{pi}R_{pq}E_{qj}\)</span>, where <span class="math notranslate nohighlight">\(E_{ij}\)</span> is the rotation matrix describing coordinate transformation between <span class="math notranslate nohighlight">\((x_1,x_2,x_3)\)</span> and <span class="math notranslate nohighlight">\((x_1',x_2',x_3')\)</span> axes system. Integral lengths in different coordinate systems can be found from the relation:</p>
<div class="math notranslate nohighlight" id="equation-ltransform">
<span class="eqno">(1.72)<a class="headerlink" href="#equation-ltransform" title="Permalink to this equation">¶</a></span>\[L_{ii}(x_1',x_2',x_3') = \sum_{k=1}^3E_{ki}^2\frac{R_{kk}(x_1,x_2,x_3)}{R_{ii}'(x_1',x_2',x_3')}L_{kk}(x_1,x_2,x_3)\]</div>
<p>In <a class="reference internal" href="#equation-ltransform">(1.72)</a>, the vector the vector potential is scaled by a function with spherical symmetry which in the case of the spectrum of decaying turbulence gives an analytic expression:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-42">
<span class="eqno">(1.73)<a class="headerlink" href="#equation-theory-turbulent-inflow-42" title="Permalink to this equation">¶</a></span>\[\mathbf{A}(x_1,x_2,x_3) = Ce^{-\frac{1}{2}k_0^2r^2}\mathbf{\gamma}\]</div>
<p>Also note that other spectra <span class="math notranslate nohighlight">\(E(k)\)</span> could be used in principle. This would result in different shapes of the inner velocity distribution. For the sake of simplicity and because it yields reasonably simple formulas, the work of <a class="bibtex reference internal" href="#kroger2018" id="id33">[4]</a> is restricted to this spectrum.</p>
<p>The spherical symmetry of <span class="math notranslate nohighlight">\(\mathbf{A}(x_1,x_2,x_3)\)</span> is the reason for the isotropy of turbulence generated using these vortons. At this level, anisotropy can be introduced by stretching the coordinates individually, i.e.,</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-43">
<span class="eqno">(1.74)<a class="headerlink" href="#equation-theory-turbulent-inflow-43" title="Permalink to this equation">¶</a></span>\[x_1\rightarrow x_1/\sigma_1,\quad x_2\rightarrow x_2/\sigma_2,\quad x_3\rightarrow x_3/\sigma_3\]</div>
<p>With this, the vector potential and velocity induced by the vorton are now written as:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-44">
<span class="eqno">(1.75)<a class="headerlink" href="#equation-theory-turbulent-inflow-44" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathbf{A}=\mathrm{exp}\left[-\frac{1}{2}\left(\frac{x_1^2}{\sigma_1^2}+\frac{x_2^2}{\sigma_2^2}+\frac{x_3^2}{\sigma_3^2}\right)\right]\left(\begin{matrix}x_1\gamma_1 \\ x_2\gamma_2 \\ x_3\gamma_3\end{matrix}\right)\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-anisotropicu">
<span class="eqno">(1.76)<a class="headerlink" href="#equation-anisotropicu" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathbf{u}'=\mathrm{exp}\left[-\frac{1}{2}\left(\frac{x_1^2}{\sigma_1^2}+\frac{x_2^2}{\sigma_2^2}+\frac{x_3^2}{\sigma_3^2}\right)\right]\left(\begin{matrix}\left(\frac{\gamma_2}{\sigma_3^2}-\frac{\gamma_3}{\sigma_2^2}\right)x_2x_3 \\ \left(\frac{\gamma_3}{\sigma_1^2}-\frac{\gamma_1}{\sigma_3^2}\right)x_1x_3 \\ \left(\frac{\gamma_1}{\sigma_2^2}-\frac{\gamma_2}{\sigma_1^2}\right)x_1x_2\end{matrix}\right)\end{split}\]</div>
<p>Note that the multiplication with the coordinates is introduced to make the resulting Reynolds stress tensor a diagonal tensor which is identified with the diagonal matrix of eigenvalues from a principal component analysis of the prescribed Reynolds stress tensor. By aligning the <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span>, <span class="math notranslate nohighlight">\(x_3\)</span>-directions of the vorton with the principal directions of the Reynolds stress tensor, arbitrary anisotropic Reynolds stresses can be reproduced. The vorton sizes <span class="math notranslate nohighlight">\(\sigma_1\)</span>, <span class="math notranslate nohighlight">\(\sigma_2\)</span> and <span class="math notranslate nohighlight">\(\sigma_3\)</span> and strength vector components <span class="math notranslate nohighlight">\(\gamma_1\)</span>, <span class="math notranslate nohighlight">\(\gamma_2\)</span> and <span class="math notranslate nohighlight">\(\gamma_3\)</span> are free parameters of the vorton and can be used to match the prescribed Reynolds stresses and integral length scales.</p>
<div class="section" id="statistical-properties-of-anisotropic-vortons">
<h3>Statistical Properties of Anisotropic Vortons<a class="headerlink" href="#statistical-properties-of-anisotropic-vortons" title="Permalink to this headline">¶</a></h3>
<p>Statistical properties can be analytically derived for homogeneous turbulence. Consider a set of fully uncorrelated vortons, i.e. <span class="math notranslate nohighlight">\(\langle\gamma_{ik}\gamma_{jm}\rangle\)</span> for each pair of <span class="math notranslate nohighlight">\(k\)</span>-th and  <span class="math notranslate nohighlight">\(m\)</span>-th vortons with strength components <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, respectively. Then the Reynolds stress <span class="math notranslate nohighlight">\(R_{ij}\)</span> of the total field is equal to the sum of Reynolds stresses produced by each vorton</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-45">
<span class="eqno">(1.77)<a class="headerlink" href="#equation-theory-turbulent-inflow-45" title="Permalink to this equation">¶</a></span>\[R_{ij} = \langle u_i'u_j' \rangle = \sum_{i=1}^{N}\langle u_{ik}'u_{jk}'\rangle = \sum_{i=1}^{N}R_{ij,k}.\]</div>
<p>Without loss of generality, the magnitude of the strength is set as unity, i.e. <span class="math notranslate nohighlight">\(|\pm\mathbf{\gamma}|=1\)</span>. Then, the expected value of the Reynolds stress <span class="math notranslate nohighlight">\(R_{ij}\)</span> at the point <span class="math notranslate nohighlight">\((0,0,0)\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-46">
<span class="eqno">(1.78)<a class="headerlink" href="#equation-theory-turbulent-inflow-46" title="Permalink to this equation">¶</a></span>\[R_{ij} = \int_V u_i'(\mathbf{\gamma},\mathbf{x})u_j'(\mathbf{\gamma},\mathbf{x})P(\mathbf{x})\mathrm{d}V\]</div>
<p>where <span class="math notranslate nohighlight">\(P(\mathbf{x})\)</span> is the probability density function in the event that the vorton is placed at the point <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. For the uniform distribution <span class="math notranslate nohighlight">\(P(\mathbf{x}) = N/V\)</span> is the vorton density. If the computational domain becomes infinite <span class="math notranslate nohighlight">\(N\)</span> should increase, so that the vorton density remains constant:</p>
<div class="math notranslate nohighlight" id="equation-anisotropicr">
<span class="eqno">(1.79)<a class="headerlink" href="#equation-anisotropicr" title="Permalink to this equation">¶</a></span>\[R_{ij} = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}u_i'u_j'\mathrm{d}x_1\mathrm{d}x_2\mathrm{d}x_3\]</div>
<p>Substitution of velocity induced by an anisotropic vorton <a class="reference internal" href="#equation-anisotropicu">(1.76)</a> in <a class="reference internal" href="#equation-anisotropicr">(1.79)</a> results in a simple formula for the principal Reynolds stresses:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-47">
<span class="eqno">(1.80)<a class="headerlink" href="#equation-theory-turbulent-inflow-47" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
&amp;R_{11} = \frac{\pi^{3/2}}{4} \frac{\sigma_1(\gamma_2\sigma_2^2-\gamma_3\sigma_3^2)^2}{\sigma_2\sigma_3} \\
&amp;R_{22} = \frac{\pi^{3/2}}{4} \frac{\sigma_2(\gamma_1\sigma_1^2-\gamma_3\sigma_3^2)^2}{\sigma_1\sigma_3} \\
&amp;R_{33} = \frac{\pi^{3/2}}{4} \frac{\sigma_3(\gamma_1\sigma_1^2-\gamma_2\sigma_2^2)^2}{\sigma_1\sigma_2}
\end{split}\end{split}\]</div>
<p>Unfortunately, there is no possibility to change the auto-correlation function since the velocities in the form of <a class="reference internal" href="#equation-anisotropicu">(1.76)</a> uniquely predetermine them</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-48">
<span class="eqno">(1.81)<a class="headerlink" href="#equation-theory-turbulent-inflow-48" title="Permalink to this equation">¶</a></span>\[\rho_{ij}(\eta_1,\eta_2,\eta_3) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} u_i'u_j'(\eta_1,\eta_2,\eta_3) \mathrm{d}x_1\mathrm{d}x_2\mathrm{d}x_3\]</div>
<p>The calculation gives:</p>
<div class="math notranslate nohighlight" id="equation-anisotropicautocorrelation">
<span class="eqno">(1.82)<a class="headerlink" href="#equation-anisotropicautocorrelation" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
    &amp;\rho_{11}(\eta_1,\eta_2,\eta_3)  = Q\frac{\sigma_1}{\sigma_2^3\sigma_3^3}\left(\gamma_2\sigma_2^2-\gamma_3\sigma_3^2\right)^2\left(\eta_2^2-2\sigma_2^2\right)\left(\eta_3^2-2\sigma_3^2\right) \\
    &amp;\rho_{22}(\eta_1,\eta_2,\eta_3)  = Q\frac{\sigma_2}{\sigma_1^3\sigma_3^3}\left(\gamma_1\sigma_1^2-\gamma_3\sigma_3^2\right)^2\left(\eta_1^2-2\sigma_1^2\right)\left(\eta_3^2-2\sigma_3^2\right) \\
    &amp;\rho_{33}(\eta_1,\eta_2,\eta_3)  = Q\frac{\sigma_3}{\sigma_1^3\sigma_2^3}\left(\gamma_1\sigma_1^2-\gamma_2\sigma_2^2\right)^2\left(\eta_2^2-2\sigma_2^2\right)\left(\eta_1^2-2\sigma_1^2\right)
\end{split}\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-49">
<span class="eqno">(1.83)<a class="headerlink" href="#equation-theory-turbulent-inflow-49" title="Permalink to this equation">¶</a></span>\[Q = \frac{\pi^{3/2}}{16}\mathrm{exp}\left[-\frac{1}{4}\left(\frac{x_1^2}{\sigma_1^2}+\frac{x_2^2}{\sigma_2^2}+\frac{x_3^2}{\sigma_3^2}\right)\right]\]</div>
<p>Also the one dimensional spectra can be calculated analytically:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-50">
<span class="eqno">(1.84)<a class="headerlink" href="#equation-theory-turbulent-inflow-50" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
    &amp;\Theta_{11}(k_1,0,0) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\rho_{11}(\eta_1,0,0)e^{ik_1\eta_1}\mathrm{d}\eta_1 = \frac{\pi}{8}\frac{\sigma_1^2}{\sigma_2\sigma_3}\left(\gamma_2\sigma_2^2-\gamma_3\sigma_3^2\right)^2 e^{-k_1^2\sigma_1^2} \\
    &amp;\Theta_{22}(0,k_2,0) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\rho_{22}(0,\eta_2,0)e^{ik_2\eta_2}\mathrm{d}\eta_2 = \frac{\pi}{8}\frac{\sigma_2^2}{\sigma_1\sigma_3}\left(\gamma_1\sigma_1^2-\gamma_3\sigma_3^2\right)^2 e^{-k_2^2\sigma_2^2} \\
    &amp;\Theta_{33}(k_1,0,k_3) = \frac{1}{2\pi}\int_{-\infty}^{\infty}\rho_{33}(0,0,\eta_3)e^{ik_3\eta_3}\mathrm{d}\eta_3 = \frac{\pi}{8}\frac{\sigma_3^2}{\sigma_1\sigma_2}\left(\gamma_1\sigma_1^2-\gamma_2\sigma_2^2\right)^2 e^{-k_3^2\sigma_3^2}
\end{split}\end{split}\]</div>
<p>As seen, the dependence of the one-dimensional spectra on wave number <span class="math notranslate nohighlight">\(e^{k^2}\)</span> is the same as that in isotropic decaying turbulence.</p>
</div>
<div class="section" id="determination-of-anisotropic-vorton-parameters">
<h3>Determination of Anisotropic Vorton Parameters<a class="headerlink" href="#determination-of-anisotropic-vorton-parameters" title="Permalink to this headline">¶</a></h3>
<p>Integration of the auto-correlation functions <a class="reference internal" href="#equation-anisotropicautocorrelation">(1.82)</a> reveals a simple and clear interpretation of stretching parameters <span class="math notranslate nohighlight">\(\sigma_i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-anisotropicscale">
<span class="eqno">(1.85)<a class="headerlink" href="#equation-anisotropicscale" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
&amp;L_{11} = \int_0^{\infty}\rho_{11}(\eta_1,0,0)/\rho_{11}(0,0,0)\mathrm{d}\eta_1 = \sqrt{\pi}\sigma_1 \\
&amp;L_{22} = \int_0^{\infty}\rho_{22}(0,\eta_2,0)/\rho_{11}(0,0,0)\mathrm{d}\eta_2 = \sqrt{\pi}\sigma_2 \\
&amp;L_{33} = \int_0^{\infty}\rho_{33}(0,0,\eta_3)/\rho_{11}(0,0,0)\mathrm{d}\eta_3 = \sqrt{\pi}\sigma_3
\end{split}\end{split}\]</div>
<p>Therefore, the parameters <span class="math notranslate nohighlight">\(\sigma_i\)</span> are uniquely determined from the last formulas <span class="math notranslate nohighlight">\(\sigma_i =L_{ii}/\sqrt{\pi}\)</span>. The vorton strength vector <span class="math notranslate nohighlight">\(\gamma\)</span> is found from the condition for Reynolds stresses:</p>
<div class="math notranslate nohighlight" id="equation-anisotropicsigma">
<span class="eqno">(1.86)<a class="headerlink" href="#equation-anisotropicsigma" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
&amp;\gamma_2\sigma_2^2-\gamma_3\sigma_3^2 = \pm\frac{2}{\pi}\sqrt{\frac{L_{22}L_{33}}{L_{11}}R_{11}} \\
&amp;\gamma_1\sigma_1^2-\gamma_3\sigma_3^2 = \pm\frac{2}{\pi}\sqrt{\frac{L_{11}L_{33}}{L_{22}}R_{22}} \\
&amp;\gamma_1\sigma_1^2-\gamma_2\sigma_2^2 = \pm\frac{2}{\pi}\sqrt{\frac{L_{11}L_{22}}{L_{33}}R_{33}}
\end{split}\end{split}\]</div>
<p>Since the determinant of <a class="reference internal" href="#equation-anisotropicsigma">(1.86)</a> is zero, a solution of the system <a class="reference internal" href="#equation-anisotropicsigma">(1.86)</a> is only possible if the following condition is satisfied:</p>
<div class="math notranslate nohighlight" id="equation-anisotropiccondition">
<span class="eqno">(1.87)<a class="headerlink" href="#equation-anisotropiccondition" title="Permalink to this equation">¶</a></span>\[\pm\sqrt{\frac{L_{22}L_{33}}{L_{11}}R_{11}}\pm\sqrt{\frac{L_{11}L_{33}}{L_{22}}R_{22}}=\pm\sqrt{\frac{L_{11}L_{22}}{L_{33}}R_{33}}\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-51">
<span class="eqno">(1.88)<a class="headerlink" href="#equation-theory-turbulent-inflow-51" title="Permalink to this equation">¶</a></span>\[L_{22} = \frac{\pm L_{11}L_{33}\sqrt{R_{22}}}{\pm L_{33}\sqrt{R_{11}}\pm L_{11}\sqrt{R_{33}}}\]</div>
<p>The signs before different terms are independent of each other. Therefore, the integral lengths can not be arbitrary. If two length scales <span class="math notranslate nohighlight">\(L_{11}\)</span> and <span class="math notranslate nohighlight">\(L_{22}\)</span> are prescribed the remaining length should satisfy the conditions above. Particularly, this solution is wrong for the isotropic turbulence since, if <span class="math notranslate nohighlight">\(R_{11} = R_{22} = R_{33}\)</span> and <span class="math notranslate nohighlight">\(L_{11} = L_{33} = L\)</span>, the third length is <span class="math notranslate nohighlight">\(L_{22} = L/2\)</span> although all integral lengths based on longitudinal auto-correlation functions should be equal. One possible remedy of the length scale restriction is to superpose two statistically independent anisotropic vortons with different parameters at the same position. It is then possible to prescribe arbitrary combinations of length scales and Reynolds stresses. Two approaches for determination of the free parameters are proposed by <a class="bibtex reference internal" href="#kroger2018" id="id34">[4]</a>:</p>
<ol class="loweralpha simple">
<li><p>Analytic Determination (Type R). In this formulation, it is intended to fulfill all prescribed Reynolds stresses at once. As becomes obvious from <a class="reference internal" href="#equation-anisotropiccondition">(1.87)</a>, then at least one length scale has to be constrained. A natural choice is to constrain <span class="math notranslate nohighlight">\(L_{33}\)</span>, which is associated with minimum principal Reynolds stress direction <span class="math notranslate nohighlight">\(R_{33}\)</span>. Thus, <span class="math notranslate nohighlight">\(L_{11}\)</span> and <span class="math notranslate nohighlight">\(L_{22}\)</span> remain unchanged while <span class="math notranslate nohighlight">\(L_{33}\)</span> follows from:</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-52">
<span class="eqno">(1.89)<a class="headerlink" href="#equation-theory-turbulent-inflow-52" title="Permalink to this equation">¶</a></span>\[L_{33} = \frac{L_{11}L_{22}\sqrt{R_{33}}}{L_{22}\sqrt{R_{11}}+L_{11}\sqrt{R_{22}}}\]</div>
<p>Finally, the vorton parameter <span class="math notranslate nohighlight">\(\gamma_i\)</span> follows from</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-53">
<span class="eqno">(1.90)<a class="headerlink" href="#equation-theory-turbulent-inflow-53" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
    &amp;\gamma_1 = 1 \\
    &amp;\gamma_2 = \frac{1}{\sigma_2^2}\left(\gamma_1\sigma_1^2+\frac{2}{\pi}\sqrt{\frac{L_{11}L_{22}}{L_{33}}R_{33}}\right) \\
    &amp;\gamma_3 = \frac{1}{\sigma_3^2}\left(\gamma_1\sigma_1^2+\frac{2}{\pi}\sqrt{\frac{L_{11}L_{33}}{L_{22}}R_{22}}\right)
\end{split}\end{split}\]</div>
<p>or</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-54">
<span class="eqno">(1.91)<a class="headerlink" href="#equation-theory-turbulent-inflow-54" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
    &amp;\gamma_1 = 1 \\
    &amp;\gamma_2 = \frac{1}{\sigma_2^2}\left(\gamma_1\sigma_1^2-\frac{2}{\pi}\sqrt{\frac{L_{11}L_{22}}{L_{33}}R_{33}}\right) \\
    &amp;\gamma_3 = \frac{1}{\sigma_3^2}\left(\gamma_1\sigma_1^2-\frac{2}{\pi}\sqrt{\frac{L_{11}L_{33}}{L_{22}}R_{22}}\right)
\end{split}\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(\sigma_i\)</span> given by <a class="reference internal" href="#equation-anisotropicscale">(1.85)</a>. By determining parameters this way, Reynolds stresses are fulfilled and length scales are only approximately fulfilled. The anisotropic turbulent spot method with this kind of parameter determination is labeled by “Type R” in the work of <a class="bibtex reference internal" href="#kroger2018" id="id35">[4]</a>.</p>
<ol class="loweralpha simple" start="2">
<li><p>Pseudo Inverse (Type L). In this approach, it is intended to fulfill all prescribed length scales. Although it is not possible to account for all Reynolds stresses at the same time, it is possible to formulate a minimization problem and solve for the closest possible Reynolds stress state. First, the <span class="math notranslate nohighlight">\(\sigma_i\)</span> are computed from the prescribed length scales <a class="reference internal" href="#equation-anisotropicscale">(1.85)</a>. With fixed length scales, the Reynolds stresses follow from the following system of equations, which is unsolvable because of the zero diagonal:</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-55">
<span class="eqno">(1.92)<a class="headerlink" href="#equation-theory-turbulent-inflow-55" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{2}{\pi}
\begin{bmatrix}
\sqrt{R_{11}L_{22}L_{33}/L_{11}} \\
\sqrt{R_{22}L_{11}L_{33}/L_{22}} \\
\sqrt{R_{33}L_{11}L_{22}/L_{33}}
\end{bmatrix}=
\begin{bmatrix}
0 &amp; \sigma_2^2 &amp;  -\sigma_3^2 \\
\sigma_1^2 &amp; 0 &amp; -\sigma_3^2 \\
\sigma_1^2 &amp; -\sigma_2^2 &amp; 0
\end{bmatrix}
\begin{bmatrix}
\gamma_1 \\
\gamma_2 \\
\gamma_3
\end{bmatrix}\end{split}\]</div>
<p>The minimization problem is solved by using the Moore-Penrose pseudo-inverse <span class="math notranslate nohighlight">\(\mathbf{M}_L^+\)</span> of <span class="math notranslate nohighlight">\(\mathbf{M}_L\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-56">
<span class="eqno">(1.93)<a class="headerlink" href="#equation-theory-turbulent-inflow-56" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{bmatrix}
\gamma_1 \\
\gamma_2 \\
\gamma_3
\end{bmatrix}=\frac{2}{\pi}\mathbf{M}_L^+
\begin{bmatrix}
\sqrt{R_{11}L_{22}L_{33}/L_{11}} \\
\sqrt{R_{22}L_{11}L_{33}/L_{22}} \\
\sqrt{R_{33}L_{11}L_{22}/L_{33}}
\end{bmatrix}\end{split}\]</div>
<p>This way, all length scales are fulfilled, but the Reynolds stresses only approximately. The anisotropic turbulent spot method with this kind of parameter determination is labeled by “Type L”.</p>
</div>
</div>
</div>
<div class="section" id="code-implementation">
<h1><span class="section-number">2. </span>Code Implementation<a class="headerlink" href="#code-implementation" title="Permalink to this headline">¶</a></h1>
<p>The turbulent inflow tool provides a simple and efficient solution for generating a spatially and temporally correlated turbulent velocity field at the inflow of the computational domain via the open-source code,  OpenFOAM. It is developed based on the digital filtering method <a class="bibtex reference internal" href="#klein2003" id="id36">[8]</a><a class="bibtex reference internal" href="#xie2008" id="id37">[1]</a>, the synthetic eddy method <a class="bibtex reference internal" href="#jarrin2006" id="id38">[2]</a><a class="bibtex reference internal" href="#poletto2013" id="id39">[3]</a> and the turbulent spot method <a class="bibtex reference internal" href="#kroger2018" id="id40">[4]</a>. The back-end of the turbulent inflow tool is a custom-designed C++ library which contains a list of turbulent velocity boundary conditions developed within OpenFOAM. These boundary conditions can be used to feed the inflow plane with time-varying turbulent velocity signals. Note that the inflow tool provides the source code for two latest standard public versions of the OpenFOAM, i.e., version 6.0 and 7.0, respectively.</p>
<p>The tool can be mainly in two approaches. For users who are quite familiar with OpenFOAM, one can download the source code of the presented boundary conditions, compile the code locally on personal computers (or servers) and then carry out simulations as if those boundary conditions are originally available in the standard OpenFOAM. Similar to other boundary conditions available in OpenFOAM, the use of the presented boundary conditions requires adding some specific entries to the related files in an OpenFOAM project. For users who are not familiar with OpenFOAM, a user-interface (i.e., the front-end of the turbulent inflow tool), which help users to customize the related entries in the OpenFOAM project, is provided.</p>
<p>Before an introduction on the input entries required, it is good to have a preliminary understanding of the file system of a general OpenFOAM project first. To start with, there are usually three folders, i.e., the <em>0</em>, <em>constant</em> and <em>system</em> folders, inside a valid project. The <em>0</em> folder contains the files which specify the initial conditions and boundary conditions for different variable fields, e.g., velocity, pressure and turbulent kinetic energy. The <em>constant</em> folder includes the files storing the geometry information of the mesh and some constant parameters related to the viscosity of the fluid and the turbulence model (if required). The <em>system</em> folder contains files which concern the specification of the time-length (or steps) of simulations, the numerical schemes employed for spatially and temporal discretization, the non-linear equation solution method and other related numerical settings.</p>
<p>As mentioned earlier, the source code of the turbulent inflow tool provides some custom-developed boundary conditions for velocities. To implement those boundary conditions during a simulation, there are three files needs to be either modified or created accordingly. These files include: the <em>U</em> file in the <em>0</em> folder, the <em>inflowProperties</em> file in the <em>constant</em> folder and the <em>controlDict</em> file in the <em>system</em> folder. Compared to the <em>U</em> and <em>controlDict</em> files which are required by default in a standard OpenFOAM project, the <em>inflowProperties</em> file is a special item required (when necessary) by the presented boundary conditions. It is designed to store some statistical properties of the target turbulence which include mean velocities, Reynolds stresses and integral length scales.</p>
<div class="section" id="modifications-regarding-the-controldict-file">
<h2><span class="section-number">2.1. </span>Modifications regarding the controlDict file<a class="headerlink" href="#modifications-regarding-the-controldict-file" title="Permalink to this headline">¶</a></h2>
<p>We now introduce the entries or scripts need to be defined in or added to the above mentioned three files respectively. To start with, we consider the <em>controlDict</em> file (inside the <em>system</em> folder) and an example of this file is given as follows.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  6
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    &quot;system&quot;;
    object      controlDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

libs (&quot;libturbulentInflow.so&quot;);

application     pisoFoam;

startFrom       startTime;

startTime       0;

stopAt          endTime;

endTime         1;

deltaT          1e-3;

writeControl    timeStep;

writeInterval   100;

purgeWrite      0;

writeFormat     ascii;

writePrecision  6;

writeCompression off;

timeFormat      general;

timePrecision   6;

runTimeModifiable true;

// ************************************************************************* //
</pre></div>
</div>
<p>The only entry needs to be added to this file is the line <em>libs(“libturbulentInflow.so”)</em>. This line tells the fluid solver to include the complied library file <em>libturbulentInflow.so</em> prior to the simulation so that the presented boundary conditions contained in this library become available for the current simulation.</p>
</div>
<div class="section" id="modifications-regarding-the-u-file">
<h2><span class="section-number">2.2. </span>Modifications regarding the U file<a class="headerlink" href="#modifications-regarding-the-u-file" title="Permalink to this headline">¶</a></h2>
<p>Subsequently, we focus on the <em>U</em> file located inside the <em>0</em> folder. It contains the information of the discrete internal field and boundary fields for the velocity at a specific time instant (see the example given below).</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  6
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       volVectorField;
    object      U;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

dimensions      [0 1 -1 0 0 0 0];

internalField   uniform (10 0 0);

boundaryField
{
    inlet
    {
        type            turbulentDFMInlet;
        filterType      exponential;
        gridFactor      1;
        filterFactor    4;
        periodicInY     true;
        periodicInZ     false;
        cleanRestart    false;
        value           $internalField;
    }

    inletOld
    {
        type            fixedValue;
        value           uniform (10 0 0);
    }

    outlet
    {
        type            zeroGradient;
    }

    wall
    {
        type            fixedValue;
        value           uniform (0 0 0);
    }
}

// ************************************************************************* //
</pre></div>
</div>
<p>The boundary conditions for velocities are all specified in the <em>boundaryField</em> dictionary, and there are several sub-dictionaries in the <em>boundaryField</em> dictionary with the names such as <em>inlet</em>, <em>outlet</em>, <em>wall</em>, etc. The name of each sub-dictionary corresponds to the name of a particular boundary patch of the mesh, and the entries contained in each sub-dictionary are the related to the boundary condition for the velocity field at the corresponding boundary patch. Let’s focus on the sub-dictionary associated with the inflow patch, i.e., the <em>inlet</em> sub-dictionary. The commonly used boundary condition for the velocity at the inflow is the <em>fixedValue</em> condition (see the sub-dictionary <em>inletOld</em>). For a <em>fixedValue</em> velocity boundary, the velocities at the <em>inlet</em> patch are constant and fixed to the vector specified inside the baskets (coming after the the <em>values</em> entry) during the simulation. In our case, we would like to the velocities at the <em>inlet</em> patch to be stochastic and time-varying. For this purpose, the developed turbulent inflow package currently provides four boundary conditions in total, i.e. <em>turbulentDFMInlet</em>, <em>turbulentSEMInlet</em>, <em>turbulentDFSEMInlet</em> and <em>turbulentATSMInlet</em>. These four boundary conditions correspond to the synthetic turbulent method by <a class="bibtex reference internal" href="#klein2003" id="id41">[8]</a>, <a class="bibtex reference internal" href="#jarrin2006" id="id42">[2]</a>, <a class="bibtex reference internal" href="#poletto2013" id="id43">[3]</a> and <a class="bibtex reference internal" href="#kroger2018" id="id44">[4]</a>, respectively.</p>
<p>Also note that each presented boundary condition is, as a matter of fact, a derived class of the <em>fixedValue</em> boundary condition. Since the initialization of the <em>fixedValue</em> boundary condition requires the specification of the <em>value</em> entry. Therefore, this entry should be defined for the four presented boundary conditions as well. However, when one of the four presented boundary conditions is employed, the velocities at the boundary will be later overwritten by the generated turbulence velocity field and consequently the <em>value</em> entry does not have any effect here. Thus, this entry can be just specified as <em>$internalField;</em> Once the <em>type</em> entry takes the <em>turbulentDFMInlet</em>, <em>turbulentSEMInlet</em>, <em>turbulentDFSEMInlet</em> or <em>turbulentATSMInlet</em> boundary condition, there are some unique entries related to each boundary condition accordingly.</p>
<p>Apart from the <em>type</em> and <em>value</em> entries, there are also some identical entries shared by the four presented boundary conditions. The entries <em>periodicInY</em> and <em>periodicInZ</em> determine whether the synthetic turbulence is periodic in <span class="math notranslate nohighlight">\(x_2\)</span> and <span class="math notranslate nohighlight">\(x_3\)</span>-direction or not, respectively. Before we discuss the <em>cleanRestart</em> entry, it should be mentioned that the four presented boundary conditions are capable of restarting the generation of the synthetic turbulence from an old time-step. This feature is achieved by storing the necessary information and numerical quantities (obtained at the current time-step) which will affect the generation of the turbulence at the next-step. The entry <em>cleanRestart</em> determines whether to disregard those information and generate a new turbulent velocity field at the beginning of a new simulation.</p>
<span id="table-tinf-theory-01"></span><table class="docutils align-center" id="id45">
<caption><span class="caption-number">Table 2.1 </span><span class="caption-text">Basic entries shared by the four presented boundary conditions</span><a class="headerlink" href="#id45" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 4%" />
<col style="width: 68%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>entry name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>descriptions</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>periodicInY</p></td>
<td><p>bool</p></td>
<td><p>if the synthetic turbulent is periodic in <span class="math notranslate nohighlight">\(x_2\)</span>-direction</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p>periodicInZ</p></td>
<td><p>bool</p></td>
<td><p>if the synthetic turbulent is periodic in <span class="math notranslate nohighlight">\(x_3\)</span>-direction</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p>cleanRestart</p></td>
<td><p>bool</p></td>
<td><p>whether to disregard old turbulence or not</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<div class="section" id="the-turbulentdfminlet-boundary-condition">
<h3>The turbulentDFMInlet boundary condition<a class="headerlink" href="#the-turbulentdfminlet-boundary-condition" title="Permalink to this headline">¶</a></h3>
<p>For the <em>turbulentDFMInlet</em> boundary condition, the unique entries to be specified are <em>filterType</em>, <em>filterFactor</em> and <em>gridFactor</em>. The <em>filterShape</em> entry refers to the type of the prescribed function for computing the filter coefficients, and requires a string input. When this entry is taken as <em>gaussian</em>, the coefficients are computed with <a class="reference internal" href="#equation-gaussian">(1.6)</a>; when this entry is taken as <em>exponential</em>, the coefficients follow from <a class="reference internal" href="#equation-exponential">(1.10)</a>. As discussed earlier, the digital filtering method should be employed on uniform spacing Cartesian grids. To make this method applies to more general cases, a virtual uniform spacing Cartesian grid system will be generated during the implementation. The velocity fluctuations will be first generated on this virtual grid and then interpolated to the discrete points on the inflow patch. The <em>gridFactor</em> entry defines ratio between the virtual grid spacing <span class="math notranslate nohighlight">\(\Delta\)</span> with the square root of the area of the smallest face element on the inflow plane. Higher <em>gridFactor</em> leads to larger grid spacing and vice versa. Finally, the <em>filterFactor</em> entry denotes the values of <span class="math notranslate nohighlight">\(N/n\)</span> where <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(n\)</span> follow from the notation in <a class="reference internal" href="#sectiondfm"><span class="std std-numref">Section 1.3</span></a>, and consequently it requires an integer input. The entries related to the <em>turbulentDFMInlet</em> boundary, their input variable types and limitations are listed in <a class="reference internal" href="#table-tinf-theory-02"><span class="std std-numref">Table 2.2</span></a>.</p>
<span id="table-tinf-theory-02"></span><table class="docutils align-center" id="id46">
<caption><span class="caption-number">Table 2.2 </span><span class="caption-text">Entries related to the <em>turbulentDFMInlet</em> boundary condition</span><a class="headerlink" href="#id46" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 19%" />
<col style="width: 10%" />
<col style="width: 49%" />
<col style="width: 22%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>entry name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>descriptions</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>filterType</p></td>
<td><p>string</p></td>
<td><p>gaussian, exponential or bessel</p></td>
<td><p>exponential</p></td>
</tr>
<tr class="row-odd"><td><p>gridFactor</p></td>
<td><p>float</p></td>
<td><p><span class="math notranslate nohighlight">\(\geq 1\)</span></p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>filterFactor</p></td>
<td><p>int</p></td>
<td><p><span class="math notranslate nohighlight">\(\geq 4\)</span></p></td>
<td><p>4</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-turbulentseminlet-boundary-condition">
<h3>The turbulentSEMInlet boundary condition<a class="headerlink" href="#the-turbulentseminlet-boundary-condition" title="Permalink to this headline">¶</a></h3>
<p>For the <em>turbulentSEMInlet</em> boundary condition, the unique entries to be specified are <em>eddyType</em> and <em>eddyDensity</em>. The <em>eddyType</em> entry refers to the type of the velocity shape function <span class="math notranslate nohighlight">\(f\)</span>. It takes an string input and currently the available options are <em>tent</em>, <em>step</em> and <em>gaussian</em> which correspond to <a class="reference internal" href="#equation-ftent">(1.55)</a>, <a class="reference internal" href="#equation-fstep">(1.57)</a> and <a class="reference internal" href="#equation-fgaussian">(1.59)</a>, respectively. The <em>eddyDensity</em> refers to the ratio between <span class="math notranslate nohighlight">\(V_B\)</span> and the sum of the eddy volumes (see <a class="reference internal" href="#sectionsem"><span class="std std-numref">Section 1.4</span></a>). Higher <em>eddyDensity</em> leads to a larger amount of synthetic eddies. It takes an scalar input with a value no less than one. The lower bound of <em>eddyDensity</em> (taken as 1 by default) ensures the eddy box (introduced in <a class="reference internal" href="#sectionsem"><span class="std std-numref">Section 1.4</span></a>), from a statistical point of view, can be covered up by the eddies. The unique entries for the <em>turbulentSEMInlet</em> condition are summarized in <a class="reference internal" href="#table-tinf-theory-03"><span class="std std-numref">Table 2.3</span></a>.</p>
<span id="table-tinf-theory-03"></span><table class="docutils align-center" id="id47">
<caption><span class="caption-number">Table 2.3 </span><span class="caption-text">Entries related to the <em>turbulentSEMInlet</em> boundary condition</span><a class="headerlink" href="#id47" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 21%" />
<col style="width: 11%" />
<col style="width: 42%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>entry name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>descriptions</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>eddyType</p></td>
<td><p>string</p></td>
<td><p>tent, step or gaussian</p></td>
<td><p>gaussian</p></td>
</tr>
<tr class="row-odd"><td><p>eddyDensity</p></td>
<td><p>float</p></td>
<td><p><span class="math notranslate nohighlight">\(\geq 1\)</span></p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="the-turbulentdfseminlet-boundary-condition">
<h3>The turbulentDFSEMInlet boundary condition<a class="headerlink" href="#the-turbulentdfseminlet-boundary-condition" title="Permalink to this headline">¶</a></h3>
<p>For the <em>turbulentDFSEMInlet</em> boundary condition, the only unique entry to be specified is <em>eddyDensity</em> whose meaning is identical to that of the <em>turbulentSEMInlet</em> boundary condition.</p>
</div>
<div class="section" id="the-turbulentatsminlet-boundary-condition">
<h3>The turbulentATSMInlet boundary condition<a class="headerlink" href="#the-turbulentatsminlet-boundary-condition" title="Permalink to this headline">¶</a></h3>
<p>For the <em>turbulentATSMInlet</em> boundary condition, the unique entries to be specified are <em>vortonType</em> and <em>vortonDensity</em>. The <em>vortonType</em> entry refers the approach parameter determination for anisotropic vortons discussed in <a class="reference internal" href="#sectionatsm"><span class="std std-numref">Section 1.6</span></a>. It takes an string input and the options currently available are <em>typeR</em> and <em>typeL</em> which correspond to <a class="reference internal" href="#equation-fstep">(1.57)</a> and <a class="reference internal" href="#equation-fgaussian">(1.59)</a>, respectively. The <em>vortonDensity</em> entry is similar to the <em>eddyDensity</em> of the <em>turbulentSEMInlet</em> boundary condition. We summarize the unique entries for the <em>turbulentATSMInlet</em> condition in <a class="reference internal" href="#table-tinf-theory-04"><span class="std std-numref">Table 2.4</span></a> for reference.</p>
<span id="table-tinf-theory-04"></span><table class="docutils align-center" id="id48">
<caption><span class="caption-number">Table 2.4 </span><span class="caption-text">Entries related to the <em>turbulentATSMInlet</em> boundary condition</span><a class="headerlink" href="#id48" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 28%" />
<col style="width: 13%" />
<col style="width: 30%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>entry name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>descriptions</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>vortonType</p></td>
<td><p>string</p></td>
<td><p>typeR or typeL</p></td>
<td><p>typeR</p></td>
</tr>
<tr class="row-odd"><td><p>vortonDensity</p></td>
<td><p>float</p></td>
<td><p><span class="math notranslate nohighlight">\(\geq 1\)</span></p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
<p>A common feature shared by the entries <em>filterFactor</em>, <em>eddyDensity</em> and <em>vortonDensity</em> mentioned above is that when they are assigned with higher values, the resulting velocity fluctuations will usually have better a quality. However higher values also means a larger consumption of mathematical calculations and computational memory. Therefore, users are suggested to balance the needs between accuracy and efficient during the implementation of those boundary conditions.</p>
</div>
</div>
<div class="section" id="specification-of-the-statistics-of-the-target-turbulence">
<h2><span class="section-number">2.3. </span>Specification of the statistics of the target turbulence<a class="headerlink" href="#specification-of-the-statistics-of-the-target-turbulence" title="Permalink to this headline">¶</a></h2>
<p>The aforementioned entries defined in the boundary conditions for velocities only concern the selection of the method and the corresponding parameters associated with the selected method. The generation of the synthetic turbulence also requires the statistical information of the target turbulence to be reproduced which include mean velocities, Reynolds stresses and integral length scales. There are mainly three approaches for the input of those information, i.e., <em>direct specification</em>, <em>interpolation</em> and <em>prescribed function</em>.</p>
<div class="section" id="direct-specification">
<h3>Direct specification<a class="headerlink" href="#direct-specification" title="Permalink to this headline">¶</a></h3>
<p>The direct specification approach is suitable for the case in which the mean velocity, Reynolds stress and length scales on each face element of the inflow plane are known in prior. In this approach, the values of those quantities can be directly specified in the <em>inlet</em> dictionary. If they are uniformly distributed on the inflow plane, the related entries are in the form of</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>boundaryField
{
    inlet
    {
        type            turbulentDFMInlet;
        filterType      exponential;
        gridFactor      1;
        filterFactor    4;
        periodicInY     true;
        periodicInZ     false;
        cleanRestart    false;
        value           $internalField;
        U               uniform 10;
        R               uniform (2.0 0.5 0.5 1.5 -0.5 1.0);
        L               uniform (0.3 0.3 0.3 0.2 0.2 0.2 0.1 0.1 0.1);
    }
}
</pre></div>
</div>
<p>The three entries displayed in the <em>inlet</em> dictionary are <em>U</em>, <em>R</em> and <em>L</em> which represent mean velocity magnitude, Reynolds stress and length scale. If <em>U</em>, <em>R</em> and <em>L</em> are not uniformly distributed on the inlet patch, the related entries should be defined in the form of</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>boundaryField
{
    inlet
    {
        type            turbulentDFMInlet;
        filterType      exponential;
        gridFactor      1;
        filterFactor    4;
        periodicInY     true;
        periodicInZ     false;
        cleanRestart    false;
        value           `internalField;
        U
        {
                         1.0
                         2.0
                         ...
                         6.0
        };
        R
        {
                       (2.0 0.5 0.5 1.5 -0.5 1.0)
                       (2.1 0.6 0.6 1.6 -0.6 1.1)
                       ...
                       (2.5 1.0 1.0 2.0 -1.0 1.5)
        };
        L
        {
                       (0.30 0.30 0.30 0.20 0.20 0.20 0.10 0.10 0.10)
                       (0.31 0.31 0.31 0.21 0.21 0.21 0.11 0.11 0.11)
                       ...
                       (0.35 0.35 0.35 0.25 0.25 0.25 0.15 0.15 0.15)
        };
    }
}
</pre></div>
</div>
<p>It is noted that each element in <em>R</em> defines a six-component symmetric tensor of the form <span class="math notranslate nohighlight">\((R_{11} \ R_{21} \ R_{31} \ R_{22} \ R_{32} \ R_{33})\)</span>. For the <em>turbulentDFMInlet</em> and <em>turbulentSEMInlet</em> boundary conditions, each element in <em>L</em> defines a nine-component tensor of the form (<span class="math notranslate nohighlight">\(L_{11}^{x_1}\)</span> <span class="math notranslate nohighlight">\(L_{11}^{x_2}\)</span> <span class="math notranslate nohighlight">\(L_{11}^{x_3}\)</span> <span class="math notranslate nohighlight">\(L_{22}^{x_1}\)</span> <span class="math notranslate nohighlight">\(L_{22}^{x_2}\)</span> <span class="math notranslate nohighlight">\(L_{22}^{x_3}\)</span> <span class="math notranslate nohighlight">\(L_{33}^{x_1}\)</span> <span class="math notranslate nohighlight">\(L_{33}^{x_2}\)</span> <span class="math notranslate nohighlight">\(L_{33}^{x_3})\)</span>. For the <em>turbulentATSMInlet</em> boundary condition, each element in <em>L</em> defines a three-component vector of the form <span class="math notranslate nohighlight">\((L_{11} \ L_{22} \ L_{33})\)</span>.  For the <em>turbulentDFSEMInlet</em> boundary condition, each element in <em>L</em> is a scalar. The main difficultly in specifying the entries <em>U</em>, <em>R</em> and <em>L</em> directly is to make sure that the sequence of the elements in each entry is properly sorted coping with the corresponding faces on the inflow plane.</p>
</div>
<div class="section" id="specification-via-interpolation">
<h3>Specification via interpolation<a class="headerlink" href="#specification-via-interpolation" title="Permalink to this headline">¶</a></h3>
<p>The mean velocities, Reynolds stresses and integral length scales on the cell-faces of the inflow plane can also be specified through face interpolation. The detailed procedures are as follows:</p>
<ul class="simple">
<li><p>Create a folder with the name <em>boundaryData</em> inside the <em>constant</em> folder of a standard OpenFOAM project.</p></li>
</ul>
<div class="align-center figure" id="id49">
<span id="fig-tinf-theory-01"></span><a class="reference internal image-reference" href="../_images/TInF-theory-01.jpg"><img alt="../_images/TInF-theory-01.jpg" src="../_images/TInF-theory-01.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.1 </span><span class="caption-text">The <em>boundaryData</em> folder</span><a class="headerlink" href="#id49" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Create another folder using the name of the inflow patch inside the above created folder.</p></li>
</ul>
<div class="align-center figure" id="id50">
<span id="fig-tinf-theory-02"></span><a class="reference internal image-reference" href="../_images/TInF-theory-02.jpg"><img alt="../_images/TInF-theory-02.jpg" src="../_images/TInF-theory-02.jpg" style="width: 800px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.2 </span><span class="caption-text">The <em>inlet</em> folder</span><a class="headerlink" href="#id50" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Add four empty files with the names <em>U</em>, <em>R</em>, <em>L</em> and <em>points</em>, respectively inside the <em>inlet</em> folder. These four files will be used to store the given values of the mean velocity magnitude, Reynolds stress, integral scale at some specific points and the locations of those points in the global coordinate system (of the computational domain).</p></li>
<li><p>The <em>U</em> file, which stores the information of mean velocity magnitudes, should be written in the format of</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(
0.000000
0.029538
0.118110
...
0.029538
0
)
</pre></div>
</div>
<p>The entries within the braces are the magnitudes of mean velocity at the corresponding points.</p>
<ul class="simple">
<li><p>The <em>R</em> file, which stores the information of Reynolds stresses, should be written in the format of</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(
(0.000000 0.000000 0.000000 0.000000 0.000000 0.000000)
(0.000137 0.000000 0.000000 0.000000 0.000000 0.000053)
(0.002183 0.000002 0.000001 0.000000 0.000000 0.000827)
...
(0.000137 0.000000 0.000000 0.000000 0.000000 0.000053)
(0.000000 0.000000 0.000000 0.000000 0.000000 0.000000)
)
</pre></div>
</div>
<p>The entries within the braces are the Reynolds stress tensors at the corresponding points.</p>
<ul class="simple">
<li><p>The <em>L</em> file, which stores the information of turbulence length scales, should be written in the format of</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(
(0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000)
(0.000024 0.000024 0.000024 0.000024 0.000024 0.000024 0.000024 0.000024 0.000024)
(0.000096 0.000096 0.000096 0.000096 0.000096 0.000096 0.000096 0.000096 0.000096)
...
(0.000024 0.000024 0.000024 0.000024 0.000024 0.000024 0.000024 0.000024 0.000024)
(0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000)
)
</pre></div>
</div>
<p>The entries within the braces are the components of the turbulence length scales at the corresponding points. Again, both the <em>turbulentDFMInlet</em> and <em>turbulentSEMInlet</em> boundary conditions employ a nine-component length scale. The <em>turbulentATSMInlet</em> and <em>turbulentDFSEMInlet</em> boundary conditions employ a three-component and one-component length scale, respectively.</p>
<ul class="simple">
<li><p>The <em>points</em> file, which stores the locations of the points in the global coordinate system, should be written in the format of</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>(
(0.000000 0.000000 0.000000)
(0.000000 0.000075 0.000000)
(0.000000 0.000301 0.000000)
...
(0.000000 2.000000 0.000000)
(0.000000 2.000000 3.000000)
)
</pre></div>
</div>
<p>It is noted that the points listed in this file should be able to define a single plane. That is to say the points should not locate on a single line or different planes. In summary, specification of statistics of target turbulent via interpolation is suitable for the case in which the mean velocities, Reynolds stresses and integral length scales at a group of selected points are available.</p>
</div>
<div class="section" id="specification-via-prescribed-functions">
<h3>Specification via prescribed functions<a class="headerlink" href="#specification-via-prescribed-functions" title="Permalink to this headline">¶</a></h3>
<p>Finally, the specification of the mean velocities, Reynolds stresses and integral length scales can also be done with the prescribed functions embedded in the presented boundary conditions. The entries related to this approach are all defined in the <em>inflowProperties</em> file in the <em>constant</em> folder. To employ this approach, the first step is to define a local coordinate system and its origin. The local <span class="math notranslate nohighlight">\((x_1',x_2',x_3')\)</span> coordinate system is constructed with its <span class="math notranslate nohighlight">\(x_1'\)</span>-axis being parallel to normal of the inflow plane and pointing towards the interior of the computational domain.</p>
<div class="align-center figure" id="id51">
<span id="fig-tinf-theory-03"></span><a class="reference internal image-reference" href="../_images/TInF-theory-03.eps"><img alt="../_images/TInF-theory-03.eps" src="../_images/TInF-theory-03.eps" style="width: 250px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.3 </span><span class="caption-text">A sketch of the Euler angles and the <span class="math notranslate nohighlight">\(N\)</span>-axis</span><a class="headerlink" href="#id51" title="Permalink to this image">¶</a></p>
</div>
<p>To determine the orientation of the <span class="math notranslate nohighlight">\(x_2'\)</span>- and <span class="math notranslate nohighlight">\(x_3'\)</span>-axis, an entry named as <em>Naxis</em> is defined which takes a vector input. This vector represents the direction of the <span class="math notranslate nohighlight">\(N\)</span>-axis (see <a class="reference internal" href="#fig-tinf-theory-03"><span class="std std-numref">Fig. 2.3</span></a>) where <span class="math notranslate nohighlight">\(N\)</span> is the intersection line of the <span class="math notranslate nohighlight">\((x_1,x_2)\)</span>-plane and <span class="math notranslate nohighlight">\((x_1',x_2')\)</span>-plane. The <span class="math notranslate nohighlight">\(x_2'\)</span>- and <span class="math notranslate nohighlight">\(x_3'\)</span>-axis are then determined by <span class="math notranslate nohighlight">\(\mathbf{x}_2' = \mathbf{x}_3'\times\mathbf{x}_1'\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}_3' = \mathbf{x}_1'\times\mathbf{N}\)</span>. The reason why we specify the direction of the <span class="math notranslate nohighlight">\(N\)</span>-axis instead of the <span class="math notranslate nohighlight">\(x_2'\)</span>- or <span class="math notranslate nohighlight">\(x_3'\)</span>-axis is because, once the direction of the <span class="math notranslate nohighlight">\(x_1'\)</span>-axis is determined, the <span class="math notranslate nohighlight">\(x_2\)</span>- and <span class="math notranslate nohighlight">\(x_3\)</span>-axis cannot be specified arbitrarily since they must be parallel to the plane orthogonal to the <span class="math notranslate nohighlight">\(x_1\)</span>-axis. In contrast, the direction of the <span class="math notranslate nohighlight">\(N\)</span>-axis can be specified arbitrarily as long as the <span class="math notranslate nohighlight">\(x_3\)</span>-components of <span class="math notranslate nohighlight">\(N\)</span> is zero. The entry <em>Naxis</em> is set as <span class="math notranslate nohighlight">\((0 \ 0 \ 0)\)</span> by default. In this case, the <span class="math notranslate nohighlight">\((x_1',x_2')\)</span>-plane and <span class="math notranslate nohighlight">\((x_1,x_2)\)</span>-plane are parallel to each other and consequently the <span class="math notranslate nohighlight">\(x_3\)</span>- and <span class="math notranslate nohighlight">\(x_3'\)</span>-axis are align.</p>
<p>Now, the remaining issue is the determination of the origin of the local coordinate system. Consider a rectangular defined on the <span class="math notranslate nohighlight">\((x_2,x_3)\)</span>-plane bounding all the nodes of the inflow patch. The origin of the local coordinate system is chosen as the lower left corner of this rectangular by default. We also allow users to offset the origin through the use of the entries <em>yOffset</em> and <em>zOffset</em> which take scalars for input.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \    /   O peration     | Website:  https://openfoam.org
    \  /    A nd           | Version:  6
     \/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    &quot;constant&quot;;
    object      inflowProperties;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

Naxis                       (0 0 0);
offset                      (0 0 0);

UDict
{
    referenceValue          1;
    profile                 uniform;
}

RDict
{
    referenceValue          (0.1  0  0  0.1  0  0.1);
    profile                 uniform;
}

LDict
{
    referenceValue          (0.3 0.2 0.1);
    profile                 uniform;
    Gamma                   (1 1 1);
}

// ************************************************************************* //
</pre></div>
</div>
<p>In addition to the entries mentioned above, there are a total of three sub-dictionaries need to be specified in the <em>inflowProperties</em> file, i.e. <em>UDict</em>, <em>RDict</em> and <em>LDict</em>, which are responsible for the specifications of the mean velocity magnitude, the Reynolds stress tensor <span class="math notranslate nohighlight">\((R_{11}, R_{21}, R_{31}, R_{22}, R_{32}, R_{33})\)</span> and the integral length scales <span class="math notranslate nohighlight">\((L_{11}^{x_1}, L_{22}^{x_2}, L_{33}^{x_3})\)</span>. Note <span class="math notranslate nohighlight">\(L_{11}^{x_1}\)</span> refers to the integral length scale obtained by integrating the two-point correlation function <span class="math notranslate nohighlight">\(R_{11}(\mathbf{x})\)</span> with respect to the local <span class="math notranslate nohighlight">\(x_1\)</span>-direction (i.e., the stream-wise direction) and similarly for <span class="math notranslate nohighlight">\(L_{22}^{x_2}\)</span> and <span class="math notranslate nohighlight">\(L_{33}^{x_3}\)</span>.</p>
<p>Each sub-dictionary contains the entries required for the computation of the values of the corresponding variable on the inlet boundary which are almost identical to each other. In all sub-dictionaries mentioned above, the two basic entries need to be specified are the <em>referenceValue</em> and the <em>profile</em>. For the <em>UDict</em> sub-dictionary, the <em>referenceValue</em> entry requires a scalar value for input, while a symmetric tensor is required for the <em>RDict</em> sub-dictionary. Finally, the <em>referenceValue</em> entry of the <em>LDict</em> sub-dictionary demands a vector.</p>
<p>On the other hand, the <em>profile</em> entry, as its name implies, defines the profile function of the corresponding variable on the inlet boundary. It takes a string variable for input, and there are only two the valid options are <em>uniform</em> and <em>exponential</em> at the present stage (expecting more in the coming future). When the <em>profile</em> entry takes <em>uniform</em>, the corresponding variable will be set universally to the reference value on the entire inflow patch; When the <em>profile</em> entry takes <em>exponential</em>, the corresponding variable will be therefore computed with an exponential function and additional entries entitled as <em>alpha</em>, <em>referenceAngl</em> and <em>referenceDist</em> should be defined as a supplement, see examples below.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>UDict
{
    referenceValue          1;
    profile                 exponential;
    referenceAngl           0;
    referenceDist           1.0;
    alpha                   0.1;
}

IDict
{
    referenceValue         (0.1  0  0  0.1  0  0.1);
    profile                 exponential;
    referenceAngl           0;
    referenceDist           1.0;
    alpha                   (0.3 0.2 0.1);
}
</pre></div>
</div>
<p>While the entries required for the same type of profile function are almost the same, the form of the exponential function differs in scalar variables (e.g., the mean velocity magnitude) and symmetric tensor variables (e.g., the turbulent intensity). For a scalar variable namely <span class="math notranslate nohighlight">\(\phi\)</span>, the corresponding exponential function has the form</p>
<div class="math notranslate nohighlight" id="equation-exponentialforscalar">
<span class="eqno">(2.1)<a class="headerlink" href="#equation-exponentialforscalar" title="Permalink to this equation">¶</a></span>\[\phi(\mathbf{x}) = \bar{\phi}\big(\frac{\mathbf{n}\cdot\mathbf{x}}{d_0}\big)^{\alpha}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{\phi}\)</span> is the reference value (defined in the <em>referenceValue</em> entry), <span class="math notranslate nohighlight">\(\alpha\)</span> is the exponential coefficient  (defined by the <em>alpha</em> entry), and <span class="math notranslate nohighlight">\(d_0\)</span> is a reference distance (defined by the <em>referenceDist</em> entry). The symbol <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is a direction vector (located on the inflow plane) to which the spatial coordinate <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> (defined in the local <span class="math notranslate nohighlight">\((x_1,x_2,x_3)\)</span> coordinate system) is projected. The direction of <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> is specified indirectly by defining the relative angle between the local <span class="math notranslate nohighlight">\(x_3\)</span>-axis and <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>, and this angle (ranging from 0 to 180 degrees) is specified in the <em>referenceAngl</em> entry. This reason behind such an approach is obvious, the <span class="math notranslate nohighlight">\(\mathbf{n}\)</span> can not be arbitrarily specified for it is located on the local <span class="math notranslate nohighlight">\(x_1x_2\)</span> (i.e., the inflow) plane. Also for obvious reasons, the reference values of the mean velocity magnitude and integral length scales should be larger than zero.</p>
<p>Finally a symmetric tensor variable (e.g., the turbulent intensity) denoted by <span class="math notranslate nohighlight">\(\mathbf{\phi}\)</span> for demonstration, the corresponding exponential function writes</p>
<div class="math notranslate nohighlight" id="equation-exponentialfortensor">
<span class="eqno">(2.2)<a class="headerlink" href="#equation-exponentialfortensor" title="Permalink to this equation">¶</a></span>\[\mathbf{\phi}(\mathbf{x}) = \sum_{\gamma=1}^s \bar{\phi}_{\gamma}\big(\frac{\mathbf{n}\cdot\mathbf{x}}{d_0}\big)^{\alpha_{\gamma}} \mathbf{M}_{\gamma},\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{\phi}_{\gamma}\)</span> (<span class="math notranslate nohighlight">\(\gamma=1,2,3\)</span>) are principal values of the reference symmetric tensor <span class="math notranslate nohighlight">\(\bar{\mathbf{\phi}}\)</span> (i.e., the one defined in the <em>referenceValue</em> entry). <span class="math notranslate nohighlight">\(\mathbf{M}_{\gamma}\)</span> (<span class="math notranslate nohighlight">\(\gamma=1,2,3\)</span>) are tensors defined by</p>
<div class="math notranslate nohighlight" id="equation-theory-turbulent-inflow-57">
<span class="eqno">(2.3)<a class="headerlink" href="#equation-theory-turbulent-inflow-57" title="Permalink to this equation">¶</a></span>\[\mathbf{M}_{\gamma} = \mathbf{a}_{\gamma} \otimes \mathbf{a}_{\gamma}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}_{\gamma}\)</span> are the eigenvectors of <span class="math notranslate nohighlight">\(\bar{\mathbf{\phi}}\)</span>. Other symbols in <a class="reference internal" href="#equation-exponentialfortensor">(2.2)</a> follow from the notation in <a class="reference internal" href="#equation-exponentialforscalar">(2.1)</a>. Also note that in <a class="reference internal" href="#equation-exponentialfortensor">(2.2)</a>, the <em>alpha</em> entry requires a three-component vector, i.e., <span class="math notranslate nohighlight">\((\alpha_1 \ \alpha_2 \ \alpha_3)\)</span>, for input. The <em>referenceValue</em> requires a six-component vector, i.e., <span class="math notranslate nohighlight">\((\bar{\phi}_{11} \ \bar{\phi}_{21} \ \bar{\phi}_{31}\ \bar{\phi}_{22} \ \bar{\phi}_{32}\ \bar{\phi}_{33})\)</span>, for input, and for obvious reasons the <span class="math notranslate nohighlight">\(\bar{\phi}_{11}\)</span>, <span class="math notranslate nohighlight">\(\bar{\phi}_{22}\)</span> and <span class="math notranslate nohighlight">\(\bar{\phi}_{33}\)</span> components should be larger than zero.</p>
<span id="table-tinf-theory-05"></span><table class="docutils align-center" id="id52">
<caption><span class="caption-number">Table 2.5 </span><span class="caption-text">Entries listed in the inflowProperties file</span><a class="headerlink" href="#id52" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 6%" />
<col style="width: 22%" />
<col style="width: 37%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head" colspan="2"><p>entry name</p></th>
<th class="head"><p>type</p></th>
<th class="head"><p>limits</p></th>
<th class="head"><p>default values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="3"><p>referenceValue</p></td>
<td><p>UDict</p></td>
<td><p>float</p></td>
<td><p>&gt;0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>LDict</p></td>
<td><p>a vector of floats</p></td>
<td><p>&gt;0</p></td>
<td><p>(1 1 1)</p></td>
</tr>
<tr class="row-even"><td><p>RDict</p></td>
<td><p>a vector of floats</p></td>
<td><p>positive definite</p></td>
<td><p>(1 1 1 1 1 1)</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>profle</p></td>
<td><p>string</p></td>
<td><p>uniform, linear or exponential</p></td>
<td><p>uniform</p></td>
</tr>
<tr class="row-even"><td colspan="2"><p>referenceDist</p></td>
<td><p>float</p></td>
<td><p>&gt;0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td colspan="2"><p>referenceAngl</p></td>
<td><p>float</p></td>
<td><p>(0 180)</p></td>
<td><p>0</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="references">
<h2><span class="section-number">2.4. </span>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p id="bibtex-bibliography-theory/turbulent_inflow-0"><dl class="citation">
<dt class="bibtex label" id="xie2008"><span class="brackets">1</span><span class="fn-backref">(<a href="#id18">1</a>,<a href="#id21">2</a>,<a href="#id23">3</a>,<a href="#id24">4</a>,<a href="#id37">5</a>)</span></dt>
<dd><p>Zheng-Tong Xie and Ian P Castro. Efficient generation of inflow conditions for large eddy simulation of street-scale flows. <em>Flow, turbulence and combustion</em>, 81(3):449–470, 2008.</p>
</dd>
<dt class="bibtex label" id="jarrin2006"><span class="brackets">2</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id25">2</a>,<a href="#id27">3</a>,<a href="#id38">4</a>,<a href="#id42">5</a>)</span></dt>
<dd><p>Nicolas Jarrin, Sofiane Benhamadouche, Dominique Laurence, and Robert Prosser. A synthetic-eddy-method for generating inflow conditions for large-eddy simulations. <em>International Journal of Heat and Fluid Flow</em>, 27(4):585–593, 2006.</p>
</dd>
<dt class="bibtex label" id="poletto2013"><span class="brackets">3</span><span class="fn-backref">(<a href="#id26">1</a>,<a href="#id28">2</a>,<a href="#id29">3</a>,<a href="#id30">4</a>,<a href="#id39">5</a>,<a href="#id43">6</a>)</span></dt>
<dd><p>R Poletto, T Craft, and A Revell. A new divergence free synthetic eddy method for the reproduction of inlet flow conditions for les. <em>Flow, turbulence and combustion</em>, 91(3):519–539, 2013.</p>
</dd>
<dt class="bibtex label" id="kroger2018"><span class="brackets">4</span><span class="fn-backref">(<a href="#id31">1</a>,<a href="#id33">2</a>,<a href="#id34">3</a>,<a href="#id35">4</a>,<a href="#id40">5</a>,<a href="#id44">6</a>)</span></dt>
<dd><p>Hannes Kröger and Nikolai Kornev. Generation of divergence free synthetic inflow turbulence with arbitrary anisotropy. <em>Computers and Fluids</em>, 165:78–88, 2018.</p>
</dd>
<dt class="bibtex label" id="wu2017"><span class="brackets"><a class="fn-backref" href="#id1">5</a></span></dt>
<dd><p>Xiaohua Wu. Inflow turbulence generation methods. <em>Annual Review of Fluid Mechanics</em>, 49:23–49, 2017.</p>
</dd>
<dt class="bibtex label" id="kraichnan1970"><span class="brackets">6</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id8">2</a>)</span></dt>
<dd><p>Robert H Kraichnan. Diffusion by a random velocity field. <em>The physics of fluids</em>, 13(1):22–31, 1970.</p>
</dd>
<dt class="bibtex label" id="hoshiya1972"><span class="brackets">7</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>Masaru Hoshiya. Simulation of multi-correlated random processes and application to structural vibration problems. In <em>Proceedings of the Japan Society of Civil Engineers</em>, number 204, 121–128. Japan Society of Civil Engineers, 1972.</p>
</dd>
<dt class="bibtex label" id="klein2003"><span class="brackets">8</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id14">2</a>,<a href="#id17">3</a>,<a href="#id22">4</a>,<a href="#id36">5</a>,<a href="#id41">6</a>)</span></dt>
<dd><p>M. Klein, A. Sadiki, and J. Janicka. A digital filter based generation of inflow data for spatially developing direct numerical or large eddy simulations. <em>Journal of Computational Physics</em>, 186(2):652–665, 2003.</p>
</dd>
<dt class="bibtex label" id="shinozuka1972"><span class="brackets"><a class="fn-backref" href="#id7">9</a></span></dt>
<dd><p>Masanobu Shinozuka and C-M Jan. Digital simulation of random processes and its applications. <em>Journal of sound and vibration</em>, 25(1):111–128, 1972.</p>
</dd>
<dt class="bibtex label" id="smirnov2001"><span class="brackets"><a class="fn-backref" href="#id9">10</a></span></dt>
<dd><p>A Smirnov, S Shi, and I Celik. Random flow generation technique for large eddy simulations and particle-dynamics modeling. <em>Journal of fluids engineering</em>, 123(2):359–371, 2001.</p>
</dd>
<dt class="bibtex label" id="yu2014"><span class="brackets"><a class="fn-backref" href="#id10">11</a></span></dt>
<dd><p>Rixin Yu and Xue-Song Bai. A fully divergence-free method for generation of inhomogeneous and anisotropic turbulence with large spatial variation. <em>Journal of Computational Physics</em>, 256:234–253, 2014.</p>
</dd>
<dt class="bibtex label" id="huang2010"><span class="brackets"><a class="fn-backref" href="#id11">12</a></span></dt>
<dd><p>SH Huang, QS Li, and JR Wu. A general inflow turbulence generator for large eddy simulation. <em>Journal of Wind Engineering and Industrial Aerodynamics</em>, 98(10-11):600–617, 2010.</p>
</dd>
<dt class="bibtex label" id="castro2017"><span class="brackets"><a class="fn-backref" href="#id12">13</a></span></dt>
<dd><p>Hugo G Castro, Rodrigo R Paz, Javier L Mroginski, and Mario A Storti. Evaluation of the proper coherence representation in random flow generation based methods. <em>Journal of Wind Engineering and Industrial Aerodynamics</em>, 168:211–227, 2017.</p>
</dd>
<dt class="bibtex label" id="aboshosha2015"><span class="brackets"><a class="fn-backref" href="#id13">14</a></span></dt>
<dd><p>Haitham Aboshosha, Ahmed Elshaer, Girma T Bitsuamlak, and Ashraf El Damatty. Consistent inflow turbulence generator for les evaluation of wind-induced responses for tall buildings. <em>Journal of Wind Engineering and Industrial Aerodynamics</em>, 142:198–216, 2015.</p>
</dd>
<dt class="bibtex label" id="lund1998"><span class="brackets"><a class="fn-backref" href="#id15">15</a></span></dt>
<dd><p>Thomas S Lund, Xiaohua Wu, and Kyle D Squires. Generation of turbulent inflow data for spatially-developing boundary layer simulations. <em>Journal of computational physics</em>, 140(2):233–258, 1998.</p>
</dd>
<dt class="bibtex label" id="kim2013"><span class="brackets"><a class="fn-backref" href="#id16">16</a></span></dt>
<dd><p>Yusik Kim, Ian P Castro, and Zheng-Tong Xie. Divergence-free turbulence inflow conditions for large-eddy simulations with incompressible flow solvers. <em>Computers &amp; Fluids</em>, 84:56–68, 2013.</p>
</dd>
<dt class="bibtex label" id="kornev2007"><span class="brackets"><a class="fn-backref" href="#id32">17</a></span></dt>
<dd><p>Kornev Nikolai and Hassel Egon. Synthesis of homogeneous anisotropic divergence-free turbulent fields with prescribed second-order statistics by vortex dipoles. <em>Physics of Fluids</em>, 19(6):68–101, 2007.</p>
</dd>
</dl>
</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="../copyright.html">Copyright</a> SimCenter, University of California at Berkeley

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-158130480-6', 'auto');
    ga('send', 'pageview');
    </script>

    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>



</body>
</html>